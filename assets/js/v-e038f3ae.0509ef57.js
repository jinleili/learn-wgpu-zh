"use strict";(self.webpackChunklearn_wgpu_zh=self.webpackChunklearn_wgpu_zh||[]).push([[4647],{727:(n,s,a)=>{a.r(s),a.d(s,{data:()=>p});const p=JSON.parse('{"key":"v-e038f3ae","path":"/integration-and-debugging/android/","title":"ğŸ†• ä¸ Android App é›†æˆ","lang":"zh-CN","frontmatter":{},"excerpt":"","headers":[{"level":2,"title":"å¼€å‘ç¯å¢ƒé…ç½®","slug":"å¼€å‘ç¯å¢ƒé…ç½®","link":"#å¼€å‘ç¯å¢ƒé…ç½®","children":[]},{"level":2,"title":"æ·»åŠ å®‰å“æ„å»ºç›®æ ‡æ”¯æŒ","slug":"æ·»åŠ å®‰å“æ„å»ºç›®æ ‡æ”¯æŒ","link":"#æ·»åŠ å®‰å“æ„å»ºç›®æ ‡æ”¯æŒ","children":[]},{"level":2,"title":"è‡ªå®šä¹‰çª—å£å¯¹è±¡","slug":"è‡ªå®šä¹‰çª—å£å¯¹è±¡","link":"#è‡ªå®šä¹‰çª—å£å¯¹è±¡","children":[]},{"level":2,"title":"å®šä¹‰ FFI","slug":"å®šä¹‰-ffi","link":"#å®šä¹‰-ffi","children":[]},{"level":2,"title":"å®ç° cargo so å­å‘½ä»¤","slug":"å®ç°-cargo-so-å­å‘½ä»¤","link":"#å®ç°-cargo-so-å­å‘½ä»¤","children":[]},{"level":2,"title":"ç¼–è¯‘ä¸º .so åº“æ–‡ä»¶","slug":"ç¼–è¯‘ä¸º-so-åº“æ–‡ä»¶","link":"#ç¼–è¯‘ä¸º-so-åº“æ–‡ä»¶","children":[]},{"level":2,"title":"è‡ªå®šä¹‰ WGPUSurfaceView","slug":"è‡ªå®šä¹‰-wgpusurfaceview","link":"#è‡ªå®šä¹‰-wgpusurfaceview","children":[]},{"level":2,"title":"App ä¸­åŠ è½½ WGPUSurfaceView","slug":"app-ä¸­åŠ è½½-wgpusurfaceview","link":"#app-ä¸­åŠ è½½-wgpusurfaceview","children":[]}],"git":{"updatedTime":1665024513000},"filePathRelative":"integration-and-debugging/android/README.md"}')},2627:(n,s,a)=>{a.r(s),a.d(s,{default:()=>S});var p=a(6252);const t=a.p+"assets/img/tools.fd432abe.png",e=a.p+"assets/img/on_android.8a526a37.png",o=(0,p.uE)('<h1 id="ğŸ†•-ä¸-android-app-é›†æˆ" tabindex="-1"><a class="header-anchor" href="#ğŸ†•-ä¸-android-app-é›†æˆ" aria-hidden="true">#</a> ğŸ†• ä¸ Android App é›†æˆ</h1><h2 id="å¼€å‘ç¯å¢ƒé…ç½®" tabindex="-1"><a class="header-anchor" href="#å¼€å‘ç¯å¢ƒé…ç½®" aria-hidden="true">#</a> å¼€å‘ç¯å¢ƒé…ç½®</h2><p>å‡è®¾ä½ çš„ç”µè„‘ä¸Šå·²ç»å®‰è£…äº† Android Studioï¼Œä»èœå•æ æ‰“å¼€ SDK ç®¡ç†å™¨ï¼ˆ<code>Tools</code> &gt; <code>SDK Manager</code> &gt; <code>Android SDK</code> &gt; <code>SDK Tools</code>ï¼‰ï¼Œå‹¾é€‰ä»¥ä¸‹ 3 ä¸ªé€‰é¡¹åç‚¹å‡» <code>OK</code> æŒ‰é’®ç¡®è®¤:</p><ul><li>Android SDK Build-Tools</li><li>Android SDK Command-line Tools</li><li>NDK(Side by side)</li></ul><img src="'+t+'"><p>ç„¶åï¼Œè®¾ç½®å¦‚ä¸‹ä¸¤ä¸ªç³»ç»Ÿç¯å¢ƒå˜é‡ï¼š</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">export</span> <span class="token assign-left variable">ANDROID_SDK_ROOT</span><span class="token operator">=</span><span class="token environment constant">$HOME</span>/Library/Android/sdk\n<span class="token comment"># æ³¨æ„ï¼Œæ­¤å¤„éœ€è¦æ›¿æ¢ä¸ºä½ ç”µè„‘ä¸Šå®‰è£…çš„ NDK çš„ç‰ˆæœ¬å·</span>\n<span class="token builtin class-name">export</span> <span class="token assign-left variable">NDK_HOME</span><span class="token operator">=</span><span class="token variable">$ANDROID_SDK_ROOT</span>/ndk/23.1.7779620\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="æ·»åŠ å®‰å“æ„å»ºç›®æ ‡æ”¯æŒ" tabindex="-1"><a class="header-anchor" href="#æ·»åŠ å®‰å“æ„å»ºç›®æ ‡æ”¯æŒ" aria-hidden="true">#</a> æ·»åŠ å®‰å“æ„å»ºç›®æ ‡æ”¯æŒ</h2><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼ŒAndroid æ¨¡æ‹Ÿå™¨å’Œè™šæ‹Ÿè®¾å¤‡è¿˜ä¸æ”¯æŒ Vulkan å›¾å½¢ APIï¼ˆä»…æ”¯æŒ OpenGL ESï¼‰ï¼Œæ‰€ä»¥å¼€å‘æˆ–è°ƒè¯• wgpu ç¨‹åºåœ¨ Android ç³»ç»Ÿä¸Šçš„è¿è¡Œæ—¶ï¼Œå»ºè®®ä½¿ç”¨çœŸæœºï¼ˆå„ç§äº‘æµ‹å¹³å°çš„äº‘çœŸæœºä¹Ÿè¡Œï¼‰ã€‚</p><p>å¦‚æœéœ€è¦æ”¯æŒæ¨¡æ‹Ÿå™¨è¿è¡Œï¼Œè¿˜å¾—åŠ ä¸Š <code>x86_64-linux-android</code> å’Œ <code>i686-linux-android</code> è¿™ä¸¤ä¸ªæ„å»ºç›®æ ‡çš„æ”¯æŒã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœæŒ‡å®šäº† wgpu é¡¹ç›®ä½¿ç”¨ Vulkan å›¾å½¢åç«¯ï¼ˆ<code>Instance::new(wgpu::Backends::VULKAN)</code>ï¼‰ï¼Œåˆ™åœ¨æ¨¡æ‹Ÿå†…è¿è¡Œæ—¶ä¼šå´©æºƒï¼š</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>rustup target <span class="token function">add</span> aarch64-linux-android armv7-linux-androideabi\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="è‡ªå®šä¹‰çª—å£å¯¹è±¡" tabindex="-1"><a class="header-anchor" href="#è‡ªå®šä¹‰çª—å£å¯¹è±¡" aria-hidden="true">#</a> è‡ªå®šä¹‰çª—å£å¯¹è±¡</h2><p>è¦å®ç°ä¸€ä¸ª wgpu é‡Œèƒ½ä½¿ç”¨çš„çª—å£å¯¹è±¡ï¼Œå°±å¿…é¡»å®ç° raw-window-handle ä¸­ <code>raw_window_handle()</code> <code>raw_display_handle()</code> è¿™ä¸¤ä¸ªåˆ†åˆ«å®šä¹‰åœ¨ <code>HasRawWindowHandle</code> <code>HasRawDisplayHandle</code> trait é‡Œçš„æŠ½è±¡æ¥å£ã€‚</p>',13),c=(0,p._)("code",null,"raw_display_handle()",-1),l=(0,p._)("code",null,"AndroidDisplayHandle",-1),i=(0,p._)("code",null,"raw_window_handle()",-1),u={href:"https://github.com/rust-windowing/raw-window-handle/blob/master/src/android.rs",target:"_blank",rel:"noopener noreferrer"},r=(0,p._)("code",null,"a_native_window",-1),d=(0,p._)("code",null,"ANativeWindow",-1),k=(0,p.uE)('<p>å…ˆç»™é¡¹ç›®æ·»åŠ å¿…è¦çš„ä¾èµ–ï¼š</p><div class="language-toml ext-toml line-numbers-mode"><pre class="language-toml"><code><span class="token punctuation">[</span><span class="token table class-name">target.&#39;cfg(target_os = &quot;android&quot;)&#39;.dependencies</span><span class="token punctuation">]</span>\n<span class="token key property">jni</span> <span class="token punctuation">=</span> <span class="token string">&quot;0.19&quot;</span>\n<span class="token comment"># æ˜Ÿå·è¡¨ç¤ºä¸é”å®šç‰¹å®šç‰ˆæœ¬ï¼Œåœ¨é¡¹ç›®æ„å»ºåŠè¿è¡Œæ—¶å§‹ç»ˆä¿æŒä½¿ç”¨æœ€æ–°ç‰ˆæœ¬</span>\n<span class="token key property">ndk-sys</span> <span class="token punctuation">=</span> <span class="token string">&quot;*&quot;</span>\n<span class="token key property">raw-window-handle</span> <span class="token punctuation">=</span> <span class="token string">&quot;0.5&quot;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç„¶åå®šä¹‰ä¸€ä¸ª <code>NativeWindow</code> ç»“æ„ä½“ï¼Œå®ƒåªæœ‰ä¸€ä¸ªå« <code>a_native_window</code> çš„å­—æ®µï¼š</p><div class="language-rust ext-rs line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">struct</span> <span class="token type-definition class-name">NativeWindow</span> <span class="token punctuation">{</span>\n    a_native_window<span class="token punctuation">:</span> <span class="token operator">*</span><span class="token keyword">mut</span> <span class="token namespace">ndk_sys<span class="token punctuation">::</span></span><span class="token class-name">ANativeWindow</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">impl</span> <span class="token class-name">NativeWindow</span> <span class="token punctuation">{</span>\n    <span class="token comment">// env å’Œ surface éƒ½æ˜¯å®‰å“ç«¯ä¼ é€’è¿‡æ¥çš„å‚æ•°</span>\n    <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token punctuation">(</span>env<span class="token punctuation">:</span> <span class="token operator">*</span><span class="token keyword">mut</span> <span class="token class-name">JNIEnv</span><span class="token punctuation">,</span> surface<span class="token punctuation">:</span> jobject<span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>\n        <span class="token keyword">let</span> a_native_window <span class="token operator">=</span> <span class="token keyword">unsafe</span> <span class="token punctuation">{</span>\n            <span class="token comment">// è·å–ä¸å®‰å“ç«¯ surface å¯¹è±¡å…³è”çš„ ANativeWindowï¼Œä»¥ä¾¿èƒ½é€šè¿‡ Rust ä¸ä¹‹äº¤äº’ã€‚</span>\n            <span class="token comment">// æ­¤å‡½æ•°åœ¨è¿”å› ANativeWindow çš„åŒæ—¶ä¼šè‡ªåŠ¨å°†å…¶å¼•ç”¨è®¡æ•° +1ï¼Œä»¥é˜²æ­¢è¯¥å¯¹è±¡åœ¨å®‰å“ç«¯è¢«æ„å¤–é‡Šæ”¾ã€‚</span>\n            <span class="token namespace">ndk_sys<span class="token punctuation">::</span></span><span class="token class-name">ANativeWindow_fromSurface</span><span class="token punctuation">(</span>env <span class="token keyword">as</span> <span class="token operator">*</span><span class="token keyword">mut</span> _<span class="token punctuation">,</span> surface <span class="token keyword">as</span> <span class="token operator">*</span><span class="token keyword">mut</span> _<span class="token punctuation">)</span>\n        <span class="token punctuation">}</span><span class="token punctuation">;</span>\n        <span class="token keyword">Self</span> <span class="token punctuation">{</span> a_native_window <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æœ€åç»™ <code>NativeWindow</code> å®ç° raw-window-handle æŠ½è±¡æ¥å£ï¼š</p><div class="language-rust ext-rs line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">unsafe</span> <span class="token keyword">impl</span> <span class="token class-name">HasRawWindowHandle</span> <span class="token keyword">for</span> <span class="token class-name">NativeWindow</span> <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function-definition function">raw_window_handle</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">RawWindowHandle</span> <span class="token punctuation">{</span>\n        <span class="token keyword">let</span> <span class="token keyword">mut</span> handle <span class="token operator">=</span> <span class="token class-name">AndroidNdkWindowHandle</span><span class="token punctuation">::</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        handle<span class="token punctuation">.</span>a_native_window <span class="token operator">=</span> <span class="token keyword">self</span><span class="token punctuation">.</span>a_native_window <span class="token keyword">as</span> <span class="token operator">*</span><span class="token keyword">mut</span> _ <span class="token keyword">as</span> <span class="token operator">*</span><span class="token keyword">mut</span> c_void<span class="token punctuation">;</span>\n        <span class="token class-name">RawWindowHandle</span><span class="token punctuation">::</span><span class="token class-name">AndroidNdk</span><span class="token punctuation">(</span>handle<span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">unsafe</span> <span class="token keyword">impl</span> <span class="token class-name">HasRawDisplayHandle</span> <span class="token keyword">for</span> <span class="token class-name">NativeWindow</span> <span class="token punctuation">{</span>\n    <span class="token keyword">fn</span> <span class="token function-definition function">raw_display_handle</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">RawDisplayHandle</span> <span class="token punctuation">{</span>\n        <span class="token class-name">RawDisplayHandle</span><span class="token punctuation">::</span><span class="token class-name">Android</span><span class="token punctuation">(</span><span class="token class-name">AndroidDisplayHandle</span><span class="token punctuation">::</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="auto-github-link"><a href="https://github.com/jinleili/wgpu-on-app/blob/d28fb4790c12282b135c9776c30bf07c8da40be9/app-surface/src/android.rs#L58-L101" target="_blank" rel="noopener noreferrer"> æŸ¥çœ‹è‡ªå®šä¹‰çª—å£å¯¹è±¡çš„å®Œæ•´æºç ï¼ </a></div><h2 id="å®šä¹‰-ffi" tabindex="-1"><a class="header-anchor" href="#å®šä¹‰-ffi" aria-hidden="true">#</a> å®šä¹‰ FFI</h2><p>Rust æœ‰ä¸€ä¸ªå…³é”®å­— <code>extern</code>ï¼ˆkotlin ä¸­å®šä¹‰ JNI å‡½æ•°æ—¶ä¹Ÿæœ‰ä¸€ä¸ªå¯¹åº”çš„å…³é”®å­—å« <code>external</code>, æˆ‘ä»¬æ¥ä¸‹æ¥ä¼šç”¨åˆ°ï¼‰ï¼Œå½“éœ€è¦ä¸å…¶ä»–è¯­è¨€ç¼–å†™çš„ä»£ç è¿›è¡Œäº¤äº’æ—¶ï¼Œç”¨äºåˆ›å»ºå’Œä½¿ç”¨<strong>å¤–éƒ¨å‡½æ•°æ¥å£</strong>ï¼ˆFFIï¼ŒForeign Function Interfaceï¼‰ã€‚FFI æ˜¯ä¸€ç§ç¼–ç¨‹è¯­è¨€å®šä¹‰å‡½æ•°çš„æ–¹å¼ï¼Œå¯ä»¥è®©ä¸åŒçš„ï¼ˆå¤–éƒ¨ï¼‰ç¼–ç¨‹è¯­è¨€è°ƒç”¨è¿™äº›å‡½æ•°ã€‚</p><p>åœ¨ Rust è¿™ä¸€ç«¯ï¼Œæˆ‘ä»¬é€šè¿‡ç»™å…¬å¼€å‡½æ•°æ·»åŠ  <code>#[no_mangle]</code> å±æ€§æ¥å…è®¸å®‰å“ç«¯è°ƒç”¨æ­¤å‡½æ•°ï¼š</p><div class="language-rust ext-rs line-numbers-mode"><pre class="language-rust"><code><span class="token attribute attr-name">#[no_mangle]</span>\n<span class="token attribute attr-name">#[jni_fn(<span class="token string">&quot;name.jinleili.wgpu.RustBridge&quot;</span>)]</span>\n<span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">createWgpuCanvas</span><span class="token punctuation">(</span>env<span class="token punctuation">:</span> <span class="token operator">*</span><span class="token keyword">mut</span> <span class="token class-name">JNIEnv</span><span class="token punctuation">,</span> _<span class="token punctuation">:</span> <span class="token class-name">JClass</span><span class="token punctuation">,</span> surface<span class="token punctuation">:</span> jobject<span class="token punctuation">,</span> idx<span class="token punctuation">:</span> jint<span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> jlong <span class="token punctuation">{</span>\n    <span class="token namespace">android_logger<span class="token punctuation">::</span></span><span class="token function">init_once</span><span class="token punctuation">(</span><span class="token class-name">Config</span><span class="token punctuation">::</span><span class="token function">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">with_min_level</span><span class="token punctuation">(</span><span class="token class-name">Level</span><span class="token punctuation">::</span><span class="token class-name">Trace</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">let</span> canvas <span class="token operator">=</span> <span class="token class-name">WgpuCanvas</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token class-name">AppSurface</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span>env <span class="token keyword">as</span> <span class="token operator">*</span><span class="token keyword">mut</span> _<span class="token punctuation">,</span> surface<span class="token punctuation">)</span><span class="token punctuation">,</span> idx <span class="token keyword">as</span> <span class="token keyword">i32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token macro property">info!</span><span class="token punctuation">(</span><span class="token string">&quot;WgpuCanvas created!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// ä½¿ç”¨ Box å¯¹ Rust å¯¹è±¡è¿›è¡Œè£…ç®±æ“ä½œã€‚</span>\n    <span class="token comment">// æˆ‘ä»¬æ— æ³•å°† Rust å¯¹è±¡ç›´æ¥ä¼ é€’ç»™å¤–éƒ¨è¯­è¨€ï¼Œé€šè¿‡è£…ç®±æ¥ä¼ é€’æ­¤å¯¹è±¡çš„è£¸æŒ‡é’ˆ </span>\n    <span class="token comment">// into_raw è¿”å›æŒ‡é’ˆçš„åŒæ—¶ï¼Œä¹Ÿå°†æ­¤å¯¹è±¡çš„å†…å­˜ç®¡ç†æƒè½¬äº¤ç»™è°ƒç”¨æ–¹</span>\n    <span class="token class-name">Box</span><span class="token punctuation">::</span><span class="token function">into_raw</span><span class="token punctuation">(</span><span class="token class-name">Box</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">as</span> jlong\n<span class="token punctuation">}</span>\n\n<span class="token attribute attr-name">#[no_mangle]</span>\n<span class="token attribute attr-name">#[jni_fn(<span class="token string">&quot;name.jinleili.wgpu.RustBridge&quot;</span>)]</span>\n<span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">enterFrame</span><span class="token punctuation">(</span>_env<span class="token punctuation">:</span> <span class="token operator">*</span><span class="token keyword">mut</span> <span class="token class-name">JNIEnv</span><span class="token punctuation">,</span> _<span class="token punctuation">:</span> <span class="token class-name">JClass</span><span class="token punctuation">,</span> obj<span class="token punctuation">:</span> jlong<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// ç›´æ¥è·å–åˆ°æŒ‡é’ˆæŒ‡ä»£çš„ Rust å¯¹è±¡çš„å¯å˜å€Ÿç”¨</span>\n    <span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token keyword">unsafe</span> <span class="token punctuation">{</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token operator">*</span><span class="token punctuation">(</span>obj <span class="token keyword">as</span> <span class="token operator">*</span><span class="token keyword">mut</span> <span class="token class-name">WgpuCanvas</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>\n    obj<span class="token punctuation">.</span><span class="token function">enter_frame</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="note"><p><code>#[no_mangle]</code> å±æ€§å‘Šè¯‰ Rust å…³é—­å‡½æ•°åç§°ä¿®æ”¹åŠŸèƒ½ã€‚å¦‚æœä¸åŠ è¿™ä¸ªå±æ€§ï¼ŒRust ç¼–è¯‘å™¨å°±ä¼šä¿®æ”¹å‡½æ•°åï¼Œè¿™æ˜¯ç°ä»£ç¼–è¯‘å™¨ä¸ºäº†è§£å†³å”¯â¼€åç§°è§£æå¼•èµ·çš„å„ç§é—®é¢˜æ‰€å¼•â¼Šçš„æŠ€æœ¯ã€‚å¦‚æœå‡½æ•°åè¢«ä¿®æ”¹äº†ï¼Œå¤–éƒ¨ç¼–ç¨‹è¯­è¨€å°±â½†æ³•æŒ‰åŸåç§°è°ƒâ½¤ï¼Œå¼€å‘è€…ä¹Ÿæ²¡åŠæ³•çŸ¥é“ä¿®æ”¹åçš„å‡½æ•°åã€‚</p></div><p><code>#[jni_fn(&quot;XXX&quot;)]</code> è¿™ä¸ªå‡½æ•°ç­¾åå±æ€§éœ€è¦é‡ç‚¹ä»‹ç»ä¸€ä¸‹ï¼Œåšè¿‡å®‰å“ JNI å¼€å‘çš„éƒ½çŸ¥é“ï¼ŒJNI å‡½æ•°çš„ç­¾åæ˜¯åˆè‡­åˆé•¿ï¼Œæ¯”å¦‚ä¸Šé¢çš„ <code>createWgpuCanvas</code> å‡½æ•°ï¼Œæ‰‹å†™ç¬¦åˆ JNI è§„èŒƒçš„å‡½æ•°ç­¾åå°±ä¼šæ˜¯ <code>Java_name_jinleili_wgpu_RustBridge_createWgpuCanvas</code> è¿™æ ·ï¼Œéš¾å†™ä¸”éš¾ç»´æŠ¤ <code>#[jni_fn(&quot;name.jinleili.wgpu.RustBridge&quot;)]</code> è¿™ä¸ªå±æ€§èƒ½è‡ªåŠ¨å¸®æˆ‘ä»¬ç”Ÿæˆå…¼å®¹ JNI çš„å‡½æ•°ç­¾åï¼Œä½¿æ­£ç¡®ç¼–å†™å‡½æ•°ç­¾åå˜å¾—æ›´åŠ å®¹æ˜“ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦ jni_fn ä¾èµ–é¡¹ï¼š</p><div class="language-toml ext-toml line-numbers-mode"><pre class="language-toml"><code><span class="token punctuation">[</span><span class="token table class-name">target.&#39;cfg(target_os = &quot;android&quot;)&#39;.dependencies</span><span class="token punctuation">]</span>\n<span class="token key property">jni_fn</span> <span class="token punctuation">=</span> <span class="token string">&quot;0.1&quot;</span>\n<span class="token comment"># å…¶å®ƒä¾èµ–é¡¹</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨å®‰å“ç«¯ï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªå‘½åç©ºé—´ä¸º <code>name.jinleili.wgpu</code> çš„ <code>RustBridge</code> ç±»æ¥åŠ è½½ Rust ç¨‹åºï¼Œå¹¶ä½¿ç”¨ <code>external</code> å…³é”®å­—æ ‡è®°å¥½å…·ä½“å®ç°åœ¨ Rust ç«¯çš„å¤–éƒ¨å‡½æ•°å£°æ˜ï¼š</p><div class="language-kotlin ext-kt line-numbers-mode"><pre class="language-kotlin"><code><span class="token keyword">package</span> name<span class="token punctuation">.</span>jinleili<span class="token punctuation">.</span>wgpu\n\n<span class="token keyword">import</span> android<span class="token punctuation">.</span>view<span class="token punctuation">.</span>Surface\n\n<span class="token keyword">class</span> RustBridge <span class="token punctuation">{</span>\n    <span class="token keyword">init</span> <span class="token punctuation">{</span>\n        System<span class="token punctuation">.</span><span class="token function">loadLibrary</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;wgpu_on_app&quot;</span></span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">external</span> <span class="token keyword">fun</span> <span class="token function">createWgpuCanvas</span><span class="token punctuation">(</span>surface<span class="token operator">:</span> Surface<span class="token punctuation">,</span> idx<span class="token operator">:</span> Int<span class="token punctuation">)</span><span class="token operator">:</span> Long\n    <span class="token keyword">external</span> <span class="token keyword">fun</span> <span class="token function">enterFrame</span><span class="token punctuation">(</span>rustObj<span class="token operator">:</span> Long<span class="token punctuation">)</span>\n    <span class="token comment">// ...</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="note"><p>ä½ å¯ä»¥ä½¿ç”¨ä»»æ„ç¬¦åˆå®‰å“è§„èŒƒçš„å‘½åç©ºé—´ï¼Œåªéœ€è¦è®°å¾—è®© Rust ç«¯ <code>#[jni_fn(&quot;&quot;)]</code> å±æ€§é‡Œçš„å­—ç¬¦ä¸²ä¸å®‰å“ç«¯ä»£ç é‡Œçš„å‘½åç©ºé—´ä¸€è‡´ã€‚</p></div><h2 id="å®ç°-cargo-so-å­å‘½ä»¤" tabindex="-1"><a class="header-anchor" href="#å®ç°-cargo-so-å­å‘½ä»¤" aria-hidden="true">#</a> å®ç° cargo so å­å‘½ä»¤</h2>',18),v=(0,p._)("code",null,"so",-1),m={href:"https://mozilla.github.io/firefox-browser-architecture/experiments/2017-09-21-rust-on-android.html",target:"_blank",rel:"noopener noreferrer"},b=(0,p._)("code",null,"so",-1),g={href:"https://crates.io",target:"_blank",rel:"noopener noreferrer"},f=(0,p.uE)('<div class="language-rust ext-rs line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">let</span> args <span class="token operator">=</span> <span class="token namespace">std<span class="token punctuation">::</span>env<span class="token punctuation">::</span></span><span class="token function">args</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">match</span> <span class="token class-name">Subcommand</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span>args<span class="token punctuation">,</span> <span class="token string">&quot;so&quot;</span><span class="token punctuation">,</span> <span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>_<span class="token punctuation">,</span> _<span class="token closure-punctuation punctuation">|</span></span> <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token class-name">Ok</span><span class="token punctuation">(</span>cmd<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">match</span> cmd<span class="token punctuation">.</span><span class="token function">cmd</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token string">&quot;build&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;b&quot;</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>\n            <span class="token keyword">let</span> ndk <span class="token operator">=</span> <span class="token class-name">Ndk</span><span class="token punctuation">::</span><span class="token function">from_env</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token keyword">let</span> build_targets <span class="token operator">=</span> <span class="token keyword">if</span> <span class="token keyword">let</span> <span class="token class-name">Some</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span> <span class="token operator">=</span> cmd<span class="token punctuation">.</span><span class="token function">target</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n                <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token class-name">Target</span><span class="token punctuation">::</span><span class="token function">from_rust_triple</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>\n            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n                <span class="token macro property">vec!</span><span class="token punctuation">[</span>\n                    <span class="token class-name">Target</span><span class="token punctuation">::</span><span class="token class-name">Arm64V8a</span><span class="token punctuation">,</span>\n                    <span class="token class-name">Target</span><span class="token punctuation">::</span><span class="token class-name">ArmV7a</span><span class="token punctuation">,</span>\n                    <span class="token class-name">Target</span><span class="token punctuation">::</span><span class="token constant">X86</span><span class="token punctuation">,</span>\n                    <span class="token class-name">Target</span><span class="token punctuation">::</span><span class="token constant">X86_64</span><span class="token punctuation">,</span>\n                <span class="token punctuation">]</span>\n            <span class="token punctuation">}</span><span class="token punctuation">;</span>\n            <span class="token keyword">for</span> target <span class="token keyword">in</span> build_targets <span class="token punctuation">{</span>\n                <span class="token keyword">let</span> triple <span class="token operator">=</span> target<span class="token punctuation">.</span><span class="token function">rust_triple</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n                <span class="token comment">// setting ar, linker value</span>\n                <span class="token keyword">let</span> <span class="token keyword">mut</span> cargo <span class="token operator">=</span> <span class="token function">cargo_ndk</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>ndk<span class="token punctuation">,</span> target<span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n                cargo<span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span><span class="token string">&quot;rustc&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n                <span class="token keyword">if</span> cmd<span class="token punctuation">.</span><span class="token function">target</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">is_none</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n                    cargo<span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span><span class="token string">&quot;--target&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>triple<span class="token punctuation">)</span><span class="token punctuation">;</span>\n                <span class="token punctuation">}</span>\n                cargo<span class="token punctuation">.</span><span class="token function">args</span><span class="token punctuation">(</span>cmd<span class="token punctuation">.</span><span class="token function">args</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n                <span class="token keyword">if</span> ndk<span class="token punctuation">.</span><span class="token function">build_tag</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">7272597</span> <span class="token punctuation">{</span>\n                    <span class="token keyword">if</span> <span class="token operator">!</span>cmd<span class="token punctuation">.</span><span class="token function">args</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token string">&quot;--&quot;</span><span class="token punctuation">.</span><span class="token function">to_owned</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n                        cargo<span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span><span class="token string">&quot;--&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n                    <span class="token punctuation">}</span>\n                    <span class="token keyword">let</span> gcc_link_dir <span class="token operator">=</span> cmd<span class="token punctuation">.</span><span class="token function">target_dir</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;gcc-temp-extra-link-libraries&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n                    <span class="token keyword">let</span> _ <span class="token operator">=</span> <span class="token namespace">std<span class="token punctuation">::</span>fs<span class="token punctuation">::</span></span><span class="token function">create_dir_all</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>gcc_link_dir<span class="token punctuation">)</span><span class="token punctuation">;</span>\n                    <span class="token namespace">std<span class="token punctuation">::</span>fs<span class="token punctuation">::</span></span><span class="token function">write</span><span class="token punctuation">(</span>gcc_link_dir<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;libgcc.a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;INPUT(-lunwind)&quot;</span><span class="token punctuation">)</span>\n                        <span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token string">&quot;Failed to write&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n                    cargo<span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span><span class="token string">&quot;-L&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span>gcc_link_dir<span class="token punctuation">)</span><span class="token punctuation">;</span>\n                <span class="token punctuation">}</span>\n\n                <span class="token keyword">if</span> <span class="token operator">!</span>cargo<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n                    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;{:?}&quot;</span><span class="token punctuation">,</span> <span class="token class-name">NdkError</span><span class="token punctuation">::</span><span class="token class-name">CmdFailed</span><span class="token punctuation">(</span>cargo<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n                <span class="token punctuation">}</span>\n            <span class="token punctuation">}</span>\n        <span class="token punctuation">}</span>\n        _ <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token class-name">Err</span><span class="token punctuation">(</span>_<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="auto-github-link"><a href="https://github.com/jinleili/wgpu-on-app/tree/master/cargo-so" target="_blank" rel="noopener noreferrer"> æŸ¥çœ‹ cargo-so æºç ï¼ </a></div><h2 id="ç¼–è¯‘ä¸º-so-åº“æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#ç¼–è¯‘ä¸º-so-åº“æ–‡ä»¶" aria-hidden="true">#</a> ç¼–è¯‘ä¸º .so åº“æ–‡ä»¶</h2><p>é¦–å…ˆï¼Œå®‰è£…æˆ‘ä»¬ä¸Šé¢å®ç° <code>so</code> å­å‘½ä»¤:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># ä» crates.io å®‰è£…</span>\n<span class="token function">cargo</span> <span class="token function">install</span> cargo-so\n<span class="token comment"># æˆ–è€…</span>\n<span class="token comment"># ä¹Ÿå¯ä»¥ä»æºç å®‰è£…</span>\n<span class="token function">cargo</span> <span class="token function">install</span> <span class="token parameter variable">--path</span> ./cargo-so\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç„¶åï¼Œä½¿ç”¨ <code>so</code> å­å‘½ä»¤æ¥æ„å»º wgpu é¡¹ç›®ï¼š</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># å°† wgpu ç¨‹åºæ„å»ºä¸º Android .so åº“æ–‡ä»¶</span>\n<span class="token function">cargo</span> so b <span class="token parameter variable">--lib</span> <span class="token parameter variable">--target</span> aarch64-linux-android <span class="token parameter variable">--release</span>\n<span class="token function">cargo</span> so b <span class="token parameter variable">--lib</span> <span class="token parameter variable">--target</span> armv7-linux-androideabi <span class="token parameter variable">--release</span>\n\n<span class="token comment"># å°† .so å¤åˆ¶åˆ°å®‰å“é¡¹ç›®çš„ jniLibs/ ç›®å½•ä¸‹</span>\n<span class="token function">cp</span> target/aarch64-linux-android/release/libwgpu_on_app.so android/app/libs/arm64-v8a/libwgpu_on_app.so\n<span class="token function">cp</span> target/armv7-linux-androideabi/release/libwgpu_on_app.so android/app/libs/armeabi-v7a/libwgpu_on_app.so\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æˆ‘ä»¬è¿˜å¯ä»¥ä¸Šé¢çš„æ„å»ºä¸å¤åˆ¶å‘½ä»¤æ”¾è¿›ä¸€ä¸ª <code>.sh</code> å‘½ä»¤è¡Œæ–‡ä»¶å†…ï¼Œä¹‹åç¼–è¯‘é¡¹ç›®æ—¶åªéœ€è¦æ‰§è¡Œæ­¤å‘½ä»¤è¡Œæ–‡ä»¶å°±å¯ä»¥äº†ï¼š</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">sh</span> ./release.sh\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="è‡ªå®šä¹‰-wgpusurfaceview" tabindex="-1"><a class="header-anchor" href="#è‡ªå®šä¹‰-wgpusurfaceview" aria-hidden="true">#</a> è‡ªå®šä¹‰ WGPUSurfaceView</h2><p>å®‰å“è§†å›¾ç»„ä»¶ <code>SurfaceView</code> æä¾›äº†ä¸€ä¸ªå¯åµŒå…¥åœ¨è§†å›¾å±‚çº§ç»“æ„ä¸­çš„ä¸“ç”¨äºç»˜åˆ¶çš„è§†å›¾ã€‚å®ƒè´Ÿè´£<strong>ç»˜åˆ¶è¡¨é¢</strong>ï¼ˆSurfaceï¼‰åœ¨å±å¹•ä¸Šçš„æ­£ç¡®ä½ç½®ï¼Œè¿˜æ§åˆ¶ç€ç»˜åˆ¶è¡¨é¢çš„åƒç´ æ ¼å¼åŠåˆ†è¾¨ç‡å¤§å°ã€‚ <code>SurfaceView</code> æŒæœ‰çš„<strong>ç»˜åˆ¶è¡¨é¢</strong>æ˜¯ç‹¬ç«‹äº App çª—å£çš„ï¼Œå¯ä»¥åœ¨å•ç‹¬çš„çº¿ç¨‹ä¸­è¿›è¡Œç»˜åˆ¶è€Œä¸å ç”¨ä¸»çº¿ç¨‹èµ„æºã€‚æ‰€ä»¥ä½¿ç”¨ <code>SurfaceView</code> å¯ä»¥å®ç°å¤æ‚è€Œé«˜æ•ˆçš„æ¸²æŸ“ï¼ˆæ¯”å¦‚ï¼Œæ¸¸æˆã€è§†é¢‘æ’­æ”¾ã€ç›¸æœºé¢„è§ˆç­‰ï¼‰ï¼Œä¸”ä¸ä¼šé˜»å¡ç”¨æˆ·äº¤äº’ï¼ˆè§¦æ‘¸ã€é”®ç›˜è¾“å…¥ç­‰ï¼‰çš„å“åº”ã€‚</p><p>å®‰å“ç³»ç»Ÿä¸Šçš„<strong>ç»˜åˆ¶è¡¨é¢</strong>æ˜¯çºµæ·±æ’åºï¼ˆZ-Orderedï¼‰çš„ï¼Œå®ƒé»˜è®¤å¤„åœ¨ App çª—å£çš„åé¢ï¼Œ <code>SurfaceView</code> é€šè¿‡åœ¨ App çª—å£ä¸Šé¢è®¾ç½®é€æ˜åŒºåŸŸæ¥å±•ç¤ºå¤„åœ¨åé¢çš„ç»˜åˆ¶è¡¨é¢ã€‚ å¦‚æœæƒ³å°†ç»˜åˆ¶è¡¨é¢æ”¾ç½®åˆ°çª—å£çš„æœ€ä¸Šå±‚ï¼Œå¯ä»¥é€šè¿‡ <code>setZOrderOnTop()</code> å‡½æ•°æ¥å®ç°ï¼š</p><div class="language-kotlin ext-kt line-numbers-mode"><pre class="language-kotlin"><code>mySurfaceView<span class="token punctuation">.</span><span class="token function">setZOrderOnTop</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="note"><p>è¿™é‡Œæœ‰å¿…è¦å¤šè§£é‡Šä¸€å¥ï¼šwgpu é‡Œçš„ <code>Surface</code> å¯¹è±¡è™½ç„¶æœ€ç»ˆæŒ‡å‘çš„å°±æ˜¯ SurfaceView æŒæœ‰çš„<code>ç»˜åˆ¶è¡¨é¢</code>ï¼Œä½†å®ƒæ˜¯ä¸€ä¸ªç»è¿‡ç»Ÿä¸€å°è£…çš„ç»“æ„ä½“ï¼Œæ‰€ä»¥å¹¶ä¸æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼š</p><div class="language-rust ext-rs line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">pub</span> <span class="token keyword">struct</span> <span class="token type-definition class-name">Surface</span> <span class="token punctuation">{</span>\n    <span class="token keyword">pub</span><span class="token punctuation">(</span><span class="token keyword">crate</span><span class="token punctuation">)</span> presentation<span class="token punctuation">:</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token class-name">Presentation</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>\n    <span class="token attribute attr-name">#[cfg(vulkan)]</span>\n    <span class="token keyword">pub</span> vulkan<span class="token punctuation">:</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token class-name">HalSurface</span><span class="token operator">&lt;</span><span class="token namespace">hal<span class="token punctuation">::</span>api<span class="token punctuation">::</span></span><span class="token class-name">Vulkan</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">,</span>\n    <span class="token attribute attr-name">#[cfg(metal)]</span>\n    <span class="token keyword">pub</span> metal<span class="token punctuation">:</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token class-name">HalSurface</span><span class="token operator">&lt;</span><span class="token namespace">hal<span class="token punctuation">::</span>api<span class="token punctuation">::</span></span><span class="token class-name">Metal</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">,</span>\n    <span class="token attribute attr-name">#[cfg(dx12)]</span>\n    <span class="token keyword">pub</span> dx12<span class="token punctuation">:</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token class-name">HalSurface</span><span class="token operator">&lt;</span><span class="token namespace">hal<span class="token punctuation">::</span>api<span class="token punctuation">::</span></span><span class="token class-name">Dx12</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">,</span>\n    <span class="token attribute attr-name">#[cfg(dx11)]</span>\n    <span class="token keyword">pub</span> dx11<span class="token punctuation">:</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token class-name">HalSurface</span><span class="token operator">&lt;</span><span class="token namespace">hal<span class="token punctuation">::</span>api<span class="token punctuation">::</span></span><span class="token class-name">Dx11</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">,</span>\n    <span class="token attribute attr-name">#[cfg(gl)]</span>\n    <span class="token keyword">pub</span> gl<span class="token punctuation">:</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token class-name">HalSurface</span><span class="token operator">&lt;</span><span class="token namespace">hal<span class="token punctuation">::</span>api<span class="token punctuation">::</span></span><span class="token class-name">Gles</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><p>çª—å£çš„è§†å›¾å±‚çº§ç»“æ„å†³å®šäº†ä¸<code>ç»˜åˆ¶è¡¨é¢</code>çš„æ­£ç¡®åˆæˆï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç»˜åˆ¶è¡¨é¢çš„å±•ç¤ºä¼šå—åˆ°è§†å›¾å±‚çº§å…³ç³»çš„å½±å“ï¼Œåœ¨ <code>SurfaceView</code> æ‰€å¤„å±‚çº§ä¹‹ä¸Šçš„è§†å›¾ä¼šè¦†ç›–ï¼ˆé®æŒ¡ï¼‰åœ¨åˆæˆåçš„ç»˜åˆ¶è¡¨é¢ä¹‹ä¸Šã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœè¦†ç›–å†…å®¹å­˜åœ¨é€æ˜åº¦ï¼Œåˆ™æ¯æ¬¡ç»˜åˆ¶è¡¨é¢æ¸²æŸ“å®Œæˆåï¼Œéƒ½ä¼šè¿›è¡Œä¸€æ¬¡å®Œæ•´çš„ <code>alpha</code> æ··åˆåˆæˆï¼Œè¿™ä¼šå¯¹æ€§èƒ½äº§ç”Ÿä¸åˆ©å½±å“ã€‚</p><p>æˆ‘ä»¬åªèƒ½é€šè¿‡ <code>SurfaceHolder</code> æ¥å£æ¥è®¿é—®ç»˜åˆ¶è¡¨é¢ã€‚å½“ <code>SurfaceView</code> åœ¨çª—å£ä¸­å¯è§æ—¶ï¼Œç»˜åˆ¶è¡¨é¢å°±ä¼šè¢«åˆ›å»ºï¼Œè€Œä¸å¯è§æ—¶ï¼ˆæ¯”å¦‚ï¼ŒApp è¢«åˆ‡æ¢åˆ°åå°è¿è¡Œï¼‰ç»˜åˆ¶è¡¨é¢ä¼šè¢«é”€æ¯ï¼Œæ‰€ä»¥éœ€è¦å®ç° <code>SurfaceHolder</code> çš„å›è°ƒæ¥å£ <code>surfaceCreated</code> åŠ <code>surfaceDestroyed</code> æ¥å‘ç°ç»˜åˆ¶è¡¨é¢çš„åˆ›å»ºå’Œé”€æ¯ã€‚ ä¸‹è¾¹çš„ä»£ç å®ç°äº†ä¸€ä¸ªç»§æ‰¿è‡ª <code>SurfaceView</code> çš„ <code>WGPUSurfaceView</code>ï¼š</p><div class="language-kotlin ext-kt line-numbers-mode"><pre class="language-kotlin"><code><span class="token comment">// ä¸ºå½“å‰ç±»å®ç° SurfaceHolder çš„å›è°ƒæ¥å£</span>\n<span class="token keyword">class</span> WGPUSurfaceView <span class="token operator">:</span> SurfaceView<span class="token punctuation">,</span> SurfaceHolder<span class="token punctuation">.</span><span class="token function">Callback2</span> <span class="token punctuation">{</span>\n    <span class="token keyword">private</span> <span class="token keyword">var</span> rustBrige <span class="token operator">=</span> <span class="token function">RustBridge</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token comment">// Rust å¯¹è±¡çš„æŒ‡é’ˆ</span>\n    <span class="token keyword">private</span> <span class="token keyword">var</span> wgpuObj<span class="token operator">:</span> Long <span class="token operator">=</span> Long<span class="token punctuation">.</span>MAX_VALUE\n    <span class="token keyword">private</span> <span class="token keyword">var</span> idx<span class="token operator">:</span> Int <span class="token operator">=</span> <span class="token number">0</span>\n\n    <span class="token comment">//...</span>\n\n    <span class="token keyword">init</span> <span class="token punctuation">{</span>\n        <span class="token comment">// å°†å½“å‰ç±»è®¾ç½®ä¸º SurfaceHolder çš„å›è°ƒæ¥å£ä»£ç†</span>\n        holder<span class="token punctuation">.</span><span class="token function">addCallback</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token comment">// ç»˜åˆ¶è¡¨é¢è¢«åˆ›å»ºåï¼Œåˆ›å»º/é‡æ–°åˆ›å»º wgpu å¯¹è±¡</span>\n    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">surfaceCreated</span><span class="token punctuation">(</span>holder<span class="token operator">:</span> SurfaceHolder<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        holder<span class="token punctuation">.</span><span class="token function">let</span> <span class="token punctuation">{</span> h <span class="token operator">-&gt;</span>\n            wgpuObj <span class="token operator">=</span> rustBrige<span class="token punctuation">.</span><span class="token function">createWgpuCanvas</span><span class="token punctuation">(</span>h<span class="token punctuation">.</span>surface<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>idx<span class="token punctuation">)</span>\n            <span class="token comment">// SurfaceView é»˜è®¤ä¸ä¼šè‡ªåŠ¨å¼€å§‹ç»˜åˆ¶ï¼ŒsetWillNotDraw(false) ç”¨äºé€šçŸ¥ App å·²ç»å‡†å¤‡å¥½å¼€å§‹ç»˜åˆ¶äº†ã€‚</span>\n            <span class="token function">setWillNotDraw</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token comment">// ç»˜åˆ¶è¡¨é¢è¢«é”€æ¯åï¼Œä¹Ÿé”€æ¯ wgpu å¯¹è±¡</span>\n    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">surfaceDestroyed</span><span class="token punctuation">(</span>holder<span class="token operator">:</span> SurfaceHolder<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">if</span> <span class="token punctuation">(</span>wgpuObj <span class="token operator">!=</span> Long<span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            rustBrige<span class="token punctuation">.</span><span class="token function">dropWgpuCanvas</span><span class="token punctuation">(</span>wgpuObj<span class="token punctuation">)</span>\n            wgpuObj <span class="token operator">=</span> Long<span class="token punctuation">.</span>MAX_VALUE\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">draw</span><span class="token punctuation">(</span>canvas<span class="token operator">:</span> Canvas<span class="token operator">?</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">draw</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span>\n        <span class="token comment">// è€ƒè™‘åˆ°è¾¹ç•Œæƒ…å†µï¼Œè¿™ä¸ªæ¡ä»¶åˆ¤æ–­ä¸èƒ½çœç•¥</span>\n        <span class="token keyword">if</span> <span class="token punctuation">(</span>wgpuObj <span class="token operator">==</span> Long<span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            <span class="token keyword">return</span>\n        <span class="token punctuation">}</span>\n        rustBrige<span class="token punctuation">.</span><span class="token function">enterFrame</span><span class="token punctuation">(</span>wgpuObj<span class="token punctuation">)</span>\n        <span class="token comment">// invalidate() å‡½æ•°é€šçŸ¥é€šçŸ¥ Appï¼Œåœ¨ä¸‹ä¸€ä¸ª UI åˆ·æ–°å‘¨æœŸé‡æ–°è°ƒç”¨ draw() å‡½æ•° </span>\n        <span class="token function">invalidate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="app-ä¸­åŠ è½½-wgpusurfaceview" tabindex="-1"><a class="header-anchor" href="#app-ä¸­åŠ è½½-wgpusurfaceview" aria-hidden="true">#</a> App ä¸­åŠ è½½ WGPUSurfaceView</h2>',18),w=(0,p._)("strong",null,"ç‰‡å…ƒ",-1),h=(0,p._)("code",null,"WGPUSurfaceView",-1),y={href:"https://developer.android.com/jetpack/compose",target:"_blank",rel:"noopener noreferrer"},_=(0,p.uE)('<div class="language-kotlin ext-kt line-numbers-mode"><pre class="language-kotlin"><code><span class="token keyword">class</span> MainActivity <span class="token operator">:</span> <span class="token function">ComponentActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token operator">:</span> Bundle<span class="token operator">?</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span>\n\n        setContent <span class="token punctuation">{</span>\n            MyApplicationTheme <span class="token punctuation">{</span>\n                <span class="token function">Surface</span><span class="token punctuation">(</span>\n                    modifier <span class="token operator">=</span> Modifier<span class="token punctuation">.</span><span class="token function">fillMaxSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n                    color <span class="token operator">=</span> <span class="token function">colorResource</span><span class="token punctuation">(</span>id <span class="token operator">=</span> R<span class="token punctuation">.</span>color<span class="token punctuation">.</span>white<span class="token punctuation">)</span>\n                <span class="token punctuation">)</span> <span class="token punctuation">{</span>\n                    <span class="token function">SurfaceCard</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n                <span class="token punctuation">}</span>\n            <span class="token punctuation">}</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token annotation builtin">@Composable</span>\n<span class="token keyword">fun</span> <span class="token function">SurfaceCard</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">val</span> screenWidth <span class="token operator">=</span> LocalConfiguration<span class="token punctuation">.</span>current<span class="token punctuation">.</span>screenWidthDp<span class="token punctuation">.</span>dp\n    <span class="token function">Column</span><span class="token punctuation">(</span>modifier <span class="token operator">=</span> Modifier<span class="token punctuation">.</span><span class="token function">fillMaxSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token function">Row</span><span class="token punctuation">(</span>\n            verticalAlignment <span class="token operator">=</span> Alignment<span class="token punctuation">.</span>CenterVertically<span class="token punctuation">,</span>\n            horizontalArrangement <span class="token operator">=</span> Arrangement<span class="token punctuation">.</span>Center\n        <span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            <span class="token function">Text</span><span class="token punctuation">(</span>text <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">&quot;wgpu on Android&quot;</span></span><span class="token punctuation">,</span> fontSize <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">.</span>sp<span class="token punctuation">,</span> fontWeight <span class="token operator">=</span> FontWeight<span class="token punctuation">.</span>Bold<span class="token punctuation">)</span>\n        <span class="token punctuation">}</span>\n        <span class="token comment">// ...</span>\n\n        <span class="token comment">// é€šè¿‡ AndroidView å®¹å™¨æ¥åŠ è½½æˆ‘ä»¬çš„ WGPUSurfaceView</span>\n        <span class="token function">AndroidView</span><span class="token punctuation">(</span>\n            factory <span class="token operator">=</span> <span class="token punctuation">{</span> ctx <span class="token operator">-&gt;</span>\n                <span class="token function">WGPUSurfaceView</span><span class="token punctuation">(</span>context <span class="token operator">=</span> ctx<span class="token punctuation">)</span>\n            <span class="token punctuation">}</span><span class="token punctuation">,</span>\n            modifier <span class="token operator">=</span> Modifier\n                <span class="token punctuation">.</span><span class="token function">fillMaxWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n                <span class="token punctuation">.</span><span class="token function">height</span><span class="token punctuation">(</span>screenWidth<span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åŸºäºä»¥ä¸Šä»£ç ï¼Œæˆ‘å†™äº†ä¸€ä¸ªå« wgpu-on-app çš„ç¤ºä¾‹ç¨‹åºï¼Œæ•ˆæœå¦‚ä¸‹ï¼š</p><img src="'+e+'"><div class="github-link"><a href="https://github.com/jinleili/wgpu-on-app" target="_blank" rel="noopener noreferrer"> æŸ¥çœ‹ wgpu-on-app å®Œæ•´é¡¹ç›®æºç ï¼ </a></div>',4),x={},S=(0,a(3744).Z)(x,[["render",function(n,s){const a=(0,p.up)("ExternalLinkIcon");return(0,p.wg)(),(0,p.iD)("div",null,[o,(0,p._)("p",null,[(0,p.Uk)("å®ç° "),c,(0,p.Uk)(" æœ€ä¸ºç®€å•, åªéœ€è¦å®ä¾‹åŒ–ä¸€ä¸ªç©ºçš„ "),l,(0,p.Uk)(" å¯¹è±¡åšä¸ºå‚æ•°ã€‚æŸ¥çœ‹ raw-window-handle çš„æºç å°±ä¼šå‘ç°ï¼Œå®ç° "),i,(0,p.Uk)(" æŠ½è±¡æ¥å£éœ€è¦ç”¨åˆ° "),(0,p._)("a",u,[(0,p.Uk)("AndroidNdkWindowHandle"),(0,p.Wm)(a)]),(0,p.Uk)(" å¯¹è±¡ï¼Œæ­¤å¯¹è±¡æœ‰ä¸€ä¸ªå« "),r,(0,p.Uk)(" çš„å­—æ®µï¼Œç”¨æ¥æŒ‡å‘å®‰å“ App çš„ "),d,(0,p.Uk)(" å®ä¾‹ã€‚ ä¸‹é¢æˆ‘ä»¬æ¥ä¸€æ­¥æ­¥å®ç°å®ƒã€‚")]),k,(0,p._)("p",null,[(0,p.Uk)("å®ç° "),v,(0,p.Uk)(" å­å‘½ä»¤çš„ç›®çš„æ˜¯ä¸ºäº†ä¸€åŠ³æ°¸é€¸åœ°è§£å†³ Rust é¡¹ç›®é…ç½® Android NDK é“¾æ¥çš„é—®é¢˜ã€‚å¦‚æœä½ å¯¹å¦‚ä½•ç»™ wgpu é¡¹ç›®æ‰‹åŠ¨é…ç½® NDK æ„Ÿå…´è¶£ï¼ŒMozilla çš„"),(0,p._)("a",m,[(0,p.Uk)("è¿™ç¯‡æ–‡ç« "),(0,p.Wm)(a)]),(0,p.Uk)("æœ‰è¯¦ç»†çš„æ­¥éª¤ã€‚ "),b,(0,p.Uk)(" å­å‘½ä»¤çš„ä»£ç éå¸¸ç®€å•ï¼Œè€Œä¸”æˆ‘å·²ç»å°†å®ƒå‘å¸ƒåˆ°äº† Rust çš„åŒ…æ³¨å†Œç½‘ç«™ "),(0,p._)("a",g,[(0,p.Uk)("crates.io"),(0,p.Wm)(a)]),(0,p.Uk)(", å¯ä»¥ç›´æ¥å®‰è£…ä½¿ç”¨ï¼š")]),f,(0,p._)("p",null,[(0,p.Uk)("ç°åœ¨å¯ä»¥åœ¨ Activity æˆ– Fragmentï¼ˆæ­¤å¤„ä»…æŒ‡å®‰å“ Fragmentï¼Œä¸ç€è‰²å™¨é‡Œçš„"),w,(0,p.Uk)("æ— å…³ï¼‰é‡ŒåŠ è½½ "),h,(0,p.Uk)(" å®ä¾‹äº†ï¼Œé€šè¿‡ XML æˆ–è€… Java/Kotlin ä»£ç æ¥åŠ è½½å¾ˆå¸¸è§ï¼Œä¸‹é¢æˆ‘ä»¬æ¥çœ‹çœ‹åœ¨å®‰å“ä¸Šçš„æ–°ä¸€ä»£ UI å¼€å‘æ¡†æ¶ "),(0,p._)("a",y,[(0,p.Uk)("Jetpack Compose"),(0,p.Wm)(a)]),(0,p.Uk)(" ä¸­å¦‚ä½•åŠ è½½ï¼š")]),_])}]])}}]);