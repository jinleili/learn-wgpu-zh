import{u as _,_ as u,o as i,c as o,k as c,a2 as p,t as h,e as l,U as v,a as w,V as m,a3 as x,a4 as y,a5 as E,a6 as b,a7 as A,a8 as $,a9 as C,aa as P,ab as z,ac as S,d as W,j as L,A as T,ad as k,ae as G,af as F,ag as N}from"./chunks/framework.d04c450e.js";import{t as R}from"./chunks/theme.fe37507e.js";const U={name:"AutoGithubLink",props:{customCodePath:""},data(){return{codePath:""}},mounted(){const e="https://github.com/jinleili/learn-wgpu-zh/tree/master/code/",{page:t}=_();!this.customCodePath||this.customCodePath==""?this.codePath=e+t.value.relativePath.replace("index.md","").replace(".md",""):this.codePath=e+this.customCodePath}};const I={class:"auto-github-link"},j=["href"];function O(e,t,a,n,s,r){return i(),o("div",I,[c("a",{href:s.codePath,target:"_blank",rel:"noopener noreferrer"}," 查看源码！ ",8,j)])}const V=u(U,[["render",O]]),B="/learn-wgpu-zh/res/wx.jpg",D={name:"JoinWeiChatGroup"},M={src:B,style:{width:"312px","margin-top":"24px"}};function H(e,t,a,n,s,r){return i(),o("img",M)}const J=u(D,[["render",H]]);function q(e){return e.replace(/\w\S*/g,function(t){return t.charAt(0).toUpperCase()+t.substr(1).toLowerCase()})}const K={name:"WasmExample",props:{example:"",autoLoad:!1},data(){return{error:"",loading:!1,exampleStarted:!1}},computed:{exampleName(){return q(this.example)}},methods:{async loadExample(){this.loading=!0,this.exampleStarted=!0;try{(await p(()=>import(`./wasm/${this.example}.js`.replace("_","-")),[])).default().then(t=>{this.loading=!1,this.exampleStarted=!0},t=>{`${t}`.includes("don't mind me. This isn't actually an error!")?(this.exampleStarted=!0,this.loading=!1):this.showErr(t)})}catch(e){this.showErr(e)}},showErr(e){this.error=`An error occurred loading "${this.example}": ${e}`,console.error(e),this.exampleStarted=!1,this.loading=!1}},async mounted(){await this.$nextTick(),this.autoLoad&&await this.loadExample()}},Q={id:"wasm-example"},X={key:0,class:"error"},Y={key:1,class:"loading"},Z=["disabled"];function ee(e,t,a,n,s,r){return i(),o("div",Q,[s.error?(i(),o("div",X,h(s.error),1)):l("",!0),s.loading?(i(),o("div",Y," 正在加载 WASM 模块 ... ")):l("",!0),s.exampleStarted?l("",!0):(i(),o("button",{key:2,onClick:t[0]||(t[0]=g=>r.loadExample()),disabled:s.loading},"点击运行 "+h(r.exampleName),9,Z))])}const te=u(K,[["render",ee]]);const ae={name:"WasmFullScreen",props:{wasmName:""},data(){return{timeOutFunctionId:0,missedResizeCount:0,can_resize_canvas:!0}},methods:{canvas_resize_completed(){this.can_resize_canvas=!0},dispatch_resize_event(){this.can_resize_canvas=!1;let e=document.getElementById("simuverse_container");e!=null&&e.dispatchEvent(new Event("canvas_size_need_change"))},window_resized(){let e=document.getElementsByClassName("VPLocalNav");var t=64;e[0]&&(t+=e[0].clientHeight);let a=document.getElementById("simuverse_container");a.style.top=t+"px",clearTimeout(this.timeOutFunctionId),this.can_resize_canvas||this.missedResizeCount>10?(this.missedResizeCount=0,this.timeOutFunctionId=setTimeout(this.dispatch_resize_event,100)):(this.missedResizeCount++,this.timeOutFunctionId=setTimeout(this.window_resized,100))},showAlert(){this.hideLoading();let e=document.getElementById("alert");e!=null&&(e.style.display="block")},hideLoading(){let e=document.getElementById("loading");e!=null&&(e.style.display="none")},async loadSimuverse(){p(()=>import(`https://jinleili.github.io/simuverse/${this.wasmName}.js`),[]).then(e=>{this.hideLoading(),e.default()}).catch(e=>{})}},async mounted(){window.onresize=this.window_resized,window.dispatch_resize_event=this.dispatch_resize_event,window.canvas_resize_completed=this.canvas_resize_completed,"navigator"in window&&"gpu"in navigator?navigator.gpu.requestAdapter().then(e=>{this.loadSimuverse()}).catch(e=>{this.showAlert()}):this.showAlert()},beforeDestroy(){delete window.onresize,delete window.dispatch_resize_event,delete window.canvas_resize_completed}},se={id:"simuverse_container"},ne=v('<div id="alert" style="display:none;"><div style="line-height:40px;">此浏览器版本不支持 WebGPU</div><div style="font-size:16px;color:#999999;">请使用 Chrome/Microsoft Edge 113 及以上版本，或者 Chrome/Edge Canary 并 <span><a href="https://jinleili.github.io/learn-wgpu-zh/#如何开启浏览器-webgpu-试验功能" class="a">开启 WebGPU 实验功能</a></span></div></div><div id="loading" style="display:block;"><div style="line-height:40px;"> WASM 加载中...</div></div>',2),ie=[ne];function oe(e,t,a,n,s,r){return i(),o("div",se,ie)}const re=u(ae,[["render",oe]]);function le(e){return e.replace(/\w\S*/g,function(t){return t.charAt(0).toUpperCase()+t.substr(1).toLowerCase()})}const de={name:"WebGPUExample",props:{example:"",autoLoad:!0},data(){return{error:"",loading:!1,exampleStarted:!1,showAlert:!1}},computed:{exampleName(){return le(this.example)}},methods:{detectWebGPUThenLoad(){"navigator"in window&&"gpu"in navigator?navigator.gpu.requestAdapter().then(e=>{this.loadExample()}).catch(e=>{this.showAlert=!0}):this.showAlert=!0},async loadExample(){this.loading=!0,this.exampleStarted=!0;try{(await p(()=>import(`./wasm/${this.example}.js`.replace("_","-")),[])).default().then(t=>{this.loading=!1,this.exampleStarted=!0},t=>{`${t}`.includes("don't mind me. This isn't actually an error!")?(this.exampleStarted=!0,this.loading=!1):this.showErr(t)})}catch(e){this.showErr(e)}},showErr(e){this.error=`An error occurred loading "${this.example}": ${e}`,console.error(e),this.exampleStarted=!1,this.loading=!1,this.showAlert=!0}},async mounted(){this.autoLoad&&this.detectWebGPUThenLoad()}},ce=["id"],ue={key:0,style:{color:"#353535","margin-top":"20px"}},pe=c("div",{style:{"line-height":"40px"}},"此浏览器版本不支持 WebGPU",-1),he=c("div",{style:{"font-size":"16px",color:"#999999"}},[w("请使用 Chrome/Microsoft Edge 113 及以上版本，或者 Chrome/Edge Canary, FireFox Nightly 并 "),c("span",null,[c("a",{href:"https://jinleili.github.io/learn-wgpu-zh/#如何开启浏览器-webgpu-试验功能",class:"a"},"开启 WebGPU 实验功能")])],-1),me=[pe,he],_e={key:1},fe=["disabled"];function ge(e,t,a,n,s,r){return i(),o("div",{id:a.example},[s.showAlert?(i(),o("div",ue,me)):l("",!0),s.loading?(i(),o("div",_e," 正在加载 WASM 模块 ... ")):l("",!0),s.exampleStarted?l("",!0):(i(),o("button",{key:2,class:"webgpu_example_button",onClick:t[0]||(t[0]=g=>r.detectWebGPUThenLoad()),disabled:s.loading},"点击运行 "+h(r.exampleName),9,fe))],8,ce)}const ve=u(de,[["render",ge]]),we={...R,enhanceApp({app:e}){e.component("AutoGithubLink",V),e.component("JoinWeiChatGroup",J),e.component("WasmExample",te),e.component("WebGPUExample",ve),e.component("WasmFullScreen",re)}};function f(e){if(e.extends){const t=f(e.extends);return{...t,...e,async enhanceApp(a){t.enhanceApp&&await t.enhanceApp(a),e.enhanceApp&&await e.enhanceApp(a)}}}return e}const d=f(we),xe=W({name:"VitePressApp",setup(){const{site:e}=_();return L(()=>{T(()=>{document.documentElement.lang=e.value.lang,document.documentElement.dir=e.value.dir})}),k(),G(),F(),d.setup&&d.setup(),()=>N(d.Layout)}});async function ye(){const e=be(),t=Ee();t.provide(y,e);const a=E(e.route);return t.provide(b,a),t.component("Content",A),t.component("ClientOnly",$),Object.defineProperties(t.config.globalProperties,{$frontmatter:{get(){return a.frontmatter.value}},$params:{get(){return a.page.value.params}}}),d.enhanceApp&&await d.enhanceApp({app:t,router:e,siteData:C}),{app:t,router:e,data:a}}function Ee(){return P(xe)}function be(){let e=m,t;return z(a=>{let n=S(a);return n?(e&&(t=n),(e||t===n)&&(n=n.replace(/\.js$/,".lean.js")),m&&(e=!1),p(()=>import(n),[])):null},d.NotFound)}m&&ye().then(({app:e,router:t,data:a})=>{t.go().then(()=>{x(t.route,a.site),e.mount("#app")})});export{ye as createApp};
