import{d as m,u as _,l as v,c as i,z as g,b as w,o,_ as u,a2 as h,t as p,C as d,a3 as y,O as x,K as c,a4 as z,p as b,k as A,a5 as $,a6 as E,a7 as C,a8 as S,a9 as P,aa as k,ab as W,ac as R,ad as L,ae as T,af as I,ag as O,ah as F}from"./chunks/framework.47e8af9d.js";import{t as G}from"./chunks/theme.0e1f5108.js";const j={class:"auto-github-link"},D=["href"],B=m({__name:"AutoGithubLink",setup(e){const{page:t}=_(),a="https://github.com/jinleili/learn-wgpu-zh/tree/master/code/",n=v(()=>a+t.value.relativePath.replace("index.md","").replace(".md",""));return(s,l)=>(o(),i("div",j,[g("a",{href:w(n),target:"_blank",rel:"noopener noreferrer"}," 查看源码！ ",8,D)]))}});const N="/learn-wgpu-zh/res/wx.jpg",V={name:"JoinWeiChatGroup"},U={src:N,style:{width:"312px","margin-top":"24px"}};function H(e,t,a,n,s,l){return o(),i("img",U)}const J=u(V,[["render",H]]);function M(e){return e.replace(/\w\S*/g,function(t){return t.charAt(0).toUpperCase()+t.substr(1).toLowerCase()})}const q={name:"WasmExample",props:{example:"",autoLoad:!1},data(){return{error:"",loading:!1,exampleStarted:!1}},computed:{exampleName(){return M(this.example)}},methods:{async loadExample(){this.loading=!0,this.exampleStarted=!0;try{(await h(()=>import(`./wasm/${this.example}.js`.replace("_","-")),[])).default().then(t=>{this.loading=!1,this.exampleStarted=!0},t=>{`${t}`.includes("don't mind me. This isn't actually an error!")?(this.exampleStarted=!0,this.loading=!1):showErr(t)})}catch(e){showErr(e)}},showErr(e){this.error=`An error occurred loading "${this.example}": ${e}`,console.error(e),this.exampleStarted=!1,this.loading=!1}},async mounted(){await this.$nextTick(),this.autoLoad&&await this.loadExample()}},K={id:"wasm-example"},Q={key:0,class:"error"},X={key:1,class:"loading"},Y=["disabled"];function Z(e,t,a,n,s,l){return o(),i("div",K,[s.error?(o(),i("div",Q,p(s.error),1)):d("",!0),s.loading?(o(),i("div",X," 正在加载 WASM 模块 ... ")):d("",!0),s.exampleStarted?d("",!0):(o(),i("button",{key:2,onClick:t[0]||(t[0]=pe=>l.loadExample()),disabled:s.loading},"点击运行 "+p(l.exampleName),9,Y))])}const ee=u(q,[["render",Z]]);const te={name:"WasmFullScreen",props:{wasmName:""},data(){return{timeOutFunctionId:0,missedResizeCount:0,can_resize_canvas:!0}},methods:{canvas_resize_completed(){this.can_resize_canvas=!0},dispatch_resize_event(){this.can_resize_canvas=!1;let e=document.getElementById("simuverse_container");e!=null&&e.dispatchEvent(new Event("canvas_size_need_change"))},window_resized(){clearTimeout(this.timeOutFunctionId),this.can_resize_canvas||this.missedResizeCount>15?(this.missedResizeCount=0,this.timeOutFunctionId=setTimeout(this.dispatch_resize_event,300)):(this.missedResizeCount++,this.timeOutFunctionId=setTimeout(this.window_resized,100))},showAlert(){this.hideLoading();let e=document.getElementById("alert");e!=null&&(e.style.display="block")},hideLoading(){let e=document.getElementById("loading");e!=null&&(e.style.display="none")},async loadSimuverse(){(await y(Object.assign({}),`../simuverse/${this.wasmName}.js`)).default().then(t=>{this.hideLoading()},t=>{})}},async mounted(){window.onresize=this.window_resized,window.dispatch_resize_event=this.dispatch_resize_event,window.canvas_resize_completed=this.canvas_resize_completed,"navigator"in window&&"gpu"in navigator?navigator.gpu.requestAdapter().then(e=>{this.loadSimuverse()}).catch(e=>{this.showAlert()}):this.showAlert()},beforeDestroy(){delete window.onresize,delete window.dispatch_resize_event,delete window.canvas_resize_completed}},ae={id:"simuverse_container"},ne=x('<div id="alert" style="display:none;"><div style="line-height:40px;">此浏览器版本不支持 WebGPU</div><div style="font-size:16px;color:#999999;">请使用 Chrome 113 及以上版本，或者 Chrome Canary 并 <span><a href="https://jinleili.github.io/learn-wgpu-zh/#如何开启浏览器-webgpu-试验功能" class="a">开启 WebGPU 实验功能</a></span></div></div><div id="loading" style="display:block;"><div style="line-height:40px;"> WASM 加载中...</div></div>',2),se=[ne];function ie(e,t,a,n,s,l){return o(),i("div",ae,se)}const oe=u(te,[["render",ie]]),re={...G,enhanceApp({app:e}){e.component("AutoGithubLink",B),e.component("JoinWeiChatGroup",J),e.component("WasmExample",ee),e.component("WasmFullScreen",oe)}};function f(e){if(e.extends){const t=f(e.extends);return{...t,...e,async enhanceApp(a){t.enhanceApp&&await t.enhanceApp(a),e.enhanceApp&&await e.enhanceApp(a)}}}return e}const r=f(re),le=m({name:"VitePressApp",setup(){const{site:e}=_();return b(()=>{A(()=>{document.documentElement.lang=e.value.lang,document.documentElement.dir=e.value.dir})}),$(),E(),C(),r.setup&&r.setup(),()=>S(r.Layout)}});async function de(){const e=ue(),t=ce();t.provide(P,e);const a=k(e.route);return t.provide(W,a),t.component("Content",R),t.component("ClientOnly",L),Object.defineProperties(t.config.globalProperties,{$frontmatter:{get(){return a.frontmatter.value}},$params:{get(){return a.page.value.params}}}),r.enhanceApp&&await r.enhanceApp({app:t,router:e,siteData:T}),{app:t,router:e,data:a}}function ce(){return I(le)}function ue(){let e=c,t;return O(a=>{let n=F(a);return e&&(t=n),(e||t===n)&&(n=n.replace(/\.js$/,".lean.js")),c&&(e=!1),h(()=>import(n),[])},r.NotFound)}c&&de().then(({app:e,router:t,data:a})=>{t.go().then(()=>{z(t.route,a.site),e.mount("#app")})});export{de as createApp};
