import{d as m,u as h,l as v,c as i,z as g,b as w,o,_ as u,a2 as p,t as _,C as d,O as y,K as c,a3 as x,p as z,k as A,a4 as E,a5 as $,a6 as b,a7 as C,a8 as S,a9 as P,aa as k,ab as W,ac as L,ad as R,ae as T,af as I,ag as O}from"./chunks/framework.05780f49.js";import{t as F}from"./chunks/theme.f6297c58.js";const G={class:"auto-github-link"},j=["href"],D=m({__name:"AutoGithubLink",setup(e){const{page:t}=h(),a="https://github.com/jinleili/learn-wgpu-zh/tree/master/code/",n=v(()=>a+t.value.relativePath.replace("index.md","").replace(".md",""));return(s,l)=>(o(),i("div",G,[g("a",{href:w(n),target:"_blank",rel:"noopener noreferrer"}," 查看源码！ ",8,j)]))}});const B="/learn-wgpu-zh/res/wx.jpg",N={name:"JoinWeiChatGroup"},V={src:B,style:{width:"312px","margin-top":"24px"}};function U(e,t,a,n,s,l){return o(),i("img",V)}const J=u(N,[["render",U]]);function M(e){return e.replace(/\w\S*/g,function(t){return t.charAt(0).toUpperCase()+t.substr(1).toLowerCase()})}const H={name:"WasmExample",props:{example:"",autoLoad:!1},data(){return{error:"",loading:!1,exampleStarted:!1}},computed:{exampleName(){return M(this.example)}},methods:{async loadExample(){this.loading=!0,this.exampleStarted=!0;try{(await p(()=>import(`./wasm/${this.example}.js`.replace("_","-")),[])).default().then(t=>{this.loading=!1,this.exampleStarted=!0},t=>{`${t}`.includes("don't mind me. This isn't actually an error!")?(this.exampleStarted=!0,this.loading=!1):showErr(t)})}catch(e){showErr(e)}},showErr(e){this.error=`An error occurred loading "${this.example}": ${e}`,console.error(e),this.exampleStarted=!1,this.loading=!1}},async mounted(){await this.$nextTick(),this.autoLoad&&await this.loadExample()}},q={id:"wasm-example"},K={key:0,class:"error"},Q={key:1,class:"loading"},X=["disabled"];function Y(e,t,a,n,s,l){return o(),i("div",q,[s.error?(o(),i("div",K,_(s.error),1)):d("",!0),s.loading?(o(),i("div",Q," 正在加载 WASM 模块 ... ")):d("",!0),s.exampleStarted?d("",!0):(o(),i("button",{key:2,onClick:t[0]||(t[0]=ue=>l.loadExample()),disabled:s.loading},"点击运行 "+_(l.exampleName),9,X))])}const Z=u(H,[["render",Y]]);const ee={name:"WasmFullScreen",props:{wasmName:""},data(){return{timeOutFunctionId:0,missedResizeCount:0,can_resize_canvas:!0}},methods:{canvas_resize_completed(){this.can_resize_canvas=!0},dispatch_resize_event(){this.can_resize_canvas=!1;let e=document.getElementById("simuverse_container");e!=null&&e.dispatchEvent(new Event("canvas_size_need_change"))},window_resized(){clearTimeout(this.timeOutFunctionId),this.can_resize_canvas||this.missedResizeCount>15?(this.missedResizeCount=0,this.timeOutFunctionId=setTimeout(this.dispatch_resize_event,300)):(this.missedResizeCount++,this.timeOutFunctionId=setTimeout(this.window_resized,100))},showAlert(){this.hideLoading();let e=document.getElementById("alert");e!=null&&(e.style.display="block")},hideLoading(){let e=document.getElementById("loading");e!=null&&(e.style.display="none")},async loadSimuverse(){p(()=>import(`https://jinleili.github.io/simuverse/${this.wasmName}.js`),[]).then(e=>{this.hideLoading(),e.default()}).catch(e=>{})}},async mounted(){window.onresize=this.window_resized,window.dispatch_resize_event=this.dispatch_resize_event,window.canvas_resize_completed=this.canvas_resize_completed,"navigator"in window&&"gpu"in navigator?navigator.gpu.requestAdapter().then(e=>{this.loadSimuverse()}).catch(e=>{this.showAlert()}):this.showAlert()},beforeDestroy(){delete window.onresize,delete window.dispatch_resize_event,delete window.canvas_resize_completed}},te={id:"simuverse_container"},ae=y('<div id="alert" style="display:none;"><div style="line-height:40px;">此浏览器版本不支持 WebGPU</div><div style="font-size:16px;color:#999999;">请使用 Chrome 113 及以上版本，或者 Chrome Canary 并 <span><a href="https://jinleili.github.io/learn-wgpu-zh/#如何开启浏览器-webgpu-试验功能" class="a">开启 WebGPU 实验功能</a></span></div></div><div id="loading" style="display:block;"><div style="line-height:40px;"> WASM 加载中...</div></div>',2),ne=[ae];function se(e,t,a,n,s,l){return o(),i("div",te,ne)}const ie=u(ee,[["render",se]]),oe={...F,enhanceApp({app:e}){e.component("AutoGithubLink",D),e.component("JoinWeiChatGroup",J),e.component("WasmExample",Z),e.component("WasmFullScreen",ie)}};function f(e){if(e.extends){const t=f(e.extends);return{...t,...e,async enhanceApp(a){t.enhanceApp&&await t.enhanceApp(a),e.enhanceApp&&await e.enhanceApp(a)}}}return e}const r=f(oe),re=m({name:"VitePressApp",setup(){const{site:e}=h();return z(()=>{A(()=>{document.documentElement.lang=e.value.lang,document.documentElement.dir=e.value.dir})}),E(),$(),b(),r.setup&&r.setup(),()=>C(r.Layout)}});async function le(){const e=ce(),t=de();t.provide(S,e);const a=P(e.route);return t.provide(k,a),t.component("Content",W),t.component("ClientOnly",L),Object.defineProperties(t.config.globalProperties,{$frontmatter:{get(){return a.frontmatter.value}},$params:{get(){return a.page.value.params}}}),r.enhanceApp&&await r.enhanceApp({app:t,router:e,siteData:R}),{app:t,router:e,data:a}}function de(){return T(re)}function ce(){let e=c,t;return I(a=>{let n=O(a);return e&&(t=n),(e||t===n)&&(n=n.replace(/\.js$/,".lean.js")),c&&(e=!1),p(()=>import(n),[])},r.NotFound)}c&&le().then(({app:e,router:t,data:a})=>{t.go().then(()=>{x(t.route,a.site),e.mount("#app")})});export{le as createApp};
