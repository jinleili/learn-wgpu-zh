<!DOCTYPE html>
<html lang="zh-CN" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Memory Layout in WGSL | å­¦ä¹  wgpu</title>
    <meta name="description" content="wgpuï¼šä¸‹ä¸€ä»£è·¨å¹³å°å›¾å½¢æ¥å£ WebGPU çš„ Rust å®ç°">
    <meta name="generator" content="VitePress v1.2.3">
    <link rel="preload stylesheet" href="/learn-wgpu-zh/assets/style.D36CxuET.css" as="style">
    
    <script type="module" src="/learn-wgpu-zh/assets/app.ByFiNKLK.js"></script>
    <link rel="preload" href="/learn-wgpu-zh/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/learn-wgpu-zh/assets/chunks/framework.CsL-9n7-.js">
    <link rel="modulepreload" href="/learn-wgpu-zh/assets/chunks/theme.D_c_uReR.js">
    <link rel="modulepreload" href="/learn-wgpu-zh/assets/showcase_alignment.md.spCaxCtG.lean.js">
    <link rel="icon" href="/learn-wgpu-zh/favicon.svg">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-5d98c3a5><!--[--><!--]--><!--[--><span tabindex="-1" data-v-0f60ec36></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-0f60ec36> Skip to content </a><!--]--><!----><header class="VPNav" data-v-5d98c3a5 data-v-ae24b3ad><div class="VPNavBar has-sidebar top" data-v-ae24b3ad data-v-ccf7ddec><div class="wrapper" data-v-ccf7ddec><div class="container" data-v-ccf7ddec><div class="title" data-v-ccf7ddec><div class="VPNavBarTitle has-sidebar" data-v-ccf7ddec data-v-ab179fa1><a class="title" href="/learn-wgpu-zh/" data-v-ab179fa1><!--[--><!--]--><!--[--><img class="VPImage logo" src="/learn-wgpu-zh/res/wgpu-logo.png" alt data-v-8426fc1a><!--]--><span data-v-ab179fa1>å­¦ä¹  wgpu</span><!--[--><!--]--></a></div></div><div class="content" data-v-ccf7ddec><div class="content-body" data-v-ccf7ddec><!--[--><!--]--><div class="VPNavBarSearch search" data-v-ccf7ddec><!----></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-ccf7ddec data-v-7f418b0f><span id="main-nav-aria-label" class="visually-hidden" data-v-7f418b0f>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/learn-wgpu-zh/simuverse" tabindex="0" data-v-7f418b0f data-v-9c663999><!--[--><span data-v-9c663999>Simuverse</span><!--]--></a><!--]--><!--[--><a class="VPLink link vp-external-link-icon VPNavBarMenuLink" href="https://github.com/jinleili/wgpu-in-app" target="_blank" rel="noreferrer" tabindex="0" data-v-7f418b0f data-v-9c663999><!--[--><span data-v-9c663999>wgpu-in-app</span><!--]--></a><!--]--><!--[--><a class="VPLink link vp-external-link-icon VPNavBarMenuLink" href="https://github.com/jinleili/bevy-in-app" target="_blank" rel="noreferrer" tabindex="0" data-v-7f418b0f data-v-9c663999><!--[--><span data-v-9c663999>bevy-in-app</span><!--]--></a><!--]--><!--]--></nav><div class="VPFlyout VPNavBarTranslations translations" data-v-ccf7ddec data-v-88af2de4 data-v-b6c34ac9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="Change language" data-v-b6c34ac9><span class="text" data-v-b6c34ac9><span class="vpi-languages option-icon" data-v-b6c34ac9></span><!----><span class="vpi-chevron-down text-icon" data-v-b6c34ac9></span></span></button><div class="menu" data-v-b6c34ac9><div class="VPMenu" data-v-b6c34ac9 data-v-e7ea1737><!----><!--[--><!--[--><div class="items" data-v-88af2de4><p class="title" data-v-88af2de4>ä¸­æ–‡</p><!--[--><div class="VPMenuLink" data-v-88af2de4 data-v-43f1e123><a class="VPLink link vp-external-link-icon" href="https://sotrh.github.io/learn-wgpu/showcase/alignment" target="_blank" rel="noreferrer" data-v-43f1e123><!--[-->English<!--]--></a></div><!--]--></div><!--]--><!--]--></div></div></div><div class="VPNavBarAppearance appearance" data-v-ccf7ddec data-v-e6aabb21><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-e6aabb21 data-v-d1f28634 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-d1f28634></span><span class="vpi-moon moon" data-v-d1f28634></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-ccf7ddec data-v-0394ad82 data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://github.com/jinleili/learn-wgpu-zh" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-eee4e7cb><span class="vpi-social-github" /></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-ccf7ddec data-v-d0bd9dde data-v-b6c34ac9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-b6c34ac9><span class="vpi-more-horizontal icon" data-v-b6c34ac9></span></button><div class="menu" data-v-b6c34ac9><div class="VPMenu" data-v-b6c34ac9 data-v-e7ea1737><!----><!--[--><!--[--><div class="group translations" data-v-d0bd9dde><p class="trans-title" data-v-d0bd9dde>ä¸­æ–‡</p><!--[--><div class="VPMenuLink" data-v-d0bd9dde data-v-43f1e123><a class="VPLink link vp-external-link-icon" href="https://sotrh.github.io/learn-wgpu/showcase/alignment" target="_blank" rel="noreferrer" data-v-43f1e123><!--[-->English<!--]--></a></div><!--]--></div><div class="group" data-v-d0bd9dde><div class="item appearance" data-v-d0bd9dde><p class="label" data-v-d0bd9dde>Appearance</p><div class="appearance-action" data-v-d0bd9dde><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-d0bd9dde data-v-d1f28634 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-d1f28634></span><span class="vpi-moon moon" data-v-d1f28634></span><!--]--></span></span></button></div></div></div><div class="group" data-v-d0bd9dde><div class="item social-links" data-v-d0bd9dde><div class="VPSocialLinks social-links-list" data-v-d0bd9dde data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://github.com/jinleili/learn-wgpu-zh" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-eee4e7cb><span class="vpi-social-github" /></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-ccf7ddec data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><div class="divider" data-v-ccf7ddec><div class="divider-line" data-v-ccf7ddec></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-5d98c3a5 data-v-a6f0e41e><div class="container" data-v-a6f0e41e><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-a6f0e41e><span class="vpi-align-left menu-icon" data-v-a6f0e41e></span><span class="menu-text" data-v-a6f0e41e>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-a6f0e41e data-v-17a5e62e><button data-v-17a5e62e>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-5d98c3a5 data-v-575e6a36><div class="curtain" data-v-575e6a36></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-575e6a36><span class="visually-hidden" id="sidebar-aria-label" data-v-575e6a36> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-575e6a36><section class="VPSidebarItem level-0" data-v-575e6a36 data-v-b8d55f3b><div class="item" role="button" tabindex="0" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><h2 class="text" data-v-b8d55f3b>åŸºç¡€</h2><!----></div><div class="items" data-v-b8d55f3b><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/learn-wgpu-zh/beginner/tutorial1-window" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>ä¾èµ–ä¸çª—å£</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/learn-wgpu-zh/beginner/tutorial2-surface/" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>å±•ç¤ºå¹³é¢ (Surface)</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/learn-wgpu-zh/beginner/tutorial3-pipeline/" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>ç®¡çº¿ (Pipeline)</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/learn-wgpu-zh/beginner/tutorial4-buffer/" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>ç¼“å†²åŒºä¸ç´¢å¼•</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/learn-wgpu-zh/beginner/tutorial5-textures/" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>çº¹ç†å’Œç»‘å®šç»„</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/learn-wgpu-zh/beginner/tutorial6-uniforms/" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Uniform ç¼“å†²åŒºä¸ 3D è™šæ‹Ÿæ‘„åƒæœº</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/learn-wgpu-zh/beginner/tutorial7-instancing/" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>å®ä¾‹åŒ–ç»˜åˆ¶</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/learn-wgpu-zh/beginner/tutorial8-depth/" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>æ·±åº¦ç¼“å†²åŒº</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/learn-wgpu-zh/beginner/tutorial9-models/" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>æ¨¡å‹åŠ è½½</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/learn-wgpu-zh/beginner/wgsl" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>ğŸ†• WGSL ç€è‰²å™¨è¯­è¨€</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-575e6a36><section class="VPSidebarItem level-0" data-v-575e6a36 data-v-b8d55f3b><div class="item" role="button" tabindex="0" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><h2 class="text" data-v-b8d55f3b>è¿›é˜¶</h2><!----></div><div class="items" data-v-b8d55f3b><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/learn-wgpu-zh/intermediate/tutorial10-lighting/" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>å…‰ç…§</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/learn-wgpu-zh/intermediate/tutorial11-normals/" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>æ³•çº¿æ˜ å°„</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/learn-wgpu-zh/intermediate/tutorial12-camera/" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>æ›´å¥½çš„æ‘„åƒæœº</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/learn-wgpu-zh/intermediate/compute-pipeline/" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>ğŸ†• è®¡ç®—ç®¡çº¿</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/learn-wgpu-zh/intermediate/vertex-animation/" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>ğŸ†• é¡¶ç‚¹åŠ¨ç”»</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/learn-wgpu-zh/intermediate/vertex-animation/universal-animation-formula" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>ğŸ†• ä¸‡èƒ½åŠ¨ç”»å…¬å¼</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/learn-wgpu-zh/intermediate/hdr/" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>æ¸²æŸ“ HDR åœºæ™¯</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-575e6a36><section class="VPSidebarItem level-0" data-v-575e6a36 data-v-b8d55f3b><div class="item" role="button" tabindex="0" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><h2 class="text" data-v-b8d55f3b>é›†æˆä¸è°ƒè¯•</h2><!----></div><div class="items" data-v-b8d55f3b><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/learn-wgpu-zh/integration-and-debugging/" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>æ¥”å­</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/learn-wgpu-zh/integration-and-debugging/ios/" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>ğŸ†• ä¸ iOS App é›†æˆ</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/learn-wgpu-zh/integration-and-debugging/android/" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>ğŸ†• ä¸ Android App é›†æˆ</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/learn-wgpu-zh/integration-and-debugging/xcode/" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>ğŸ†• ä½¿ç”¨ Xcode è°ƒè¯• wgpu ç¨‹åº</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/learn-wgpu-zh/integration-and-debugging/snapdragon-profiler/" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>ğŸ†• ä½¿ç”¨ Snapdragon Profiler è°ƒè¯•</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/learn-wgpu-zh/integration-and-debugging/bevy/" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>ğŸ†• åœ¨ iOS Android App ä¸­é›†æˆ Bevy æ¸¸æˆå¼•æ“</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-575e6a36><section class="VPSidebarItem level-0 collapsible collapsed" data-v-575e6a36 data-v-b8d55f3b><div class="item" role="button" tabindex="0" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><h2 class="text" data-v-b8d55f3b>æ¡ˆä¾‹å±•ç¤º</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b8d55f3b><span class="vpi-chevron-right caret-icon" data-v-b8d55f3b></span></div></div><div class="items" data-v-b8d55f3b><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/learn-wgpu-zh/showcase/windowless/" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>ç¦»å±æ¸²æŸ“</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/learn-wgpu-zh/showcase/gifs/" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>ç”Ÿæˆ GIF åŠ¨å›¾</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/learn-wgpu-zh/showcase/pong/" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Pong</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/learn-wgpu-zh/showcase/compute/" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Compute Example: Tangents and Bitangents</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-575e6a36><section class="VPSidebarItem level-0" data-v-575e6a36 data-v-b8d55f3b><div class="item" role="button" tabindex="0" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><h2 class="text" data-v-b8d55f3b>é™„å½•</h2><!----></div><div class="items" data-v-b8d55f3b><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/learn-wgpu-zh/index" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>ä»‹ç»</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/learn-wgpu-zh/GLOSSARY_OF_TERMS" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>æœ¯è¯­ä¸­è‹±å¯¹ç…§è¡¨</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-5d98c3a5 data-v-1428d186><div class="VPDoc has-sidebar has-aside" data-v-1428d186 data-v-39a288b8><!--[--><!--]--><div class="container" data-v-39a288b8><div class="aside" data-v-39a288b8><div class="aside-curtain" data-v-39a288b8></div><div class="aside-container" data-v-39a288b8><div class="aside-content" data-v-39a288b8><div class="VPDocAside" data-v-39a288b8 data-v-3f215769><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-3f215769 data-v-a5bbad30><div class="content" data-v-a5bbad30><div class="outline-marker" data-v-a5bbad30></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-a5bbad30>æœ¬ç« å†…å®¹</div><ul class="VPDocOutlineItem root" data-v-a5bbad30 data-v-b933a997><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-39a288b8><div class="content-container" data-v-39a288b8><!--[--><!--]--><main class="main" data-v-39a288b8><div style="position:relative;" class="vp-doc _learn-wgpu-zh_showcase_alignment" data-v-39a288b8><div><h1 id="memory-layout-in-wgsl" tabindex="-1">Memory Layout in WGSL <a class="header-anchor" href="#memory-layout-in-wgsl" aria-label="Permalink to &quot;Memory Layout in WGSL&quot;">â€‹</a></h1><div class="warn"><p>This page is currently being reworked. I want to understand the topics a bit better, but as 0.12 is out I want to release what I have for now.</p></div><h2 id="alignment-of-vertex-and-index-buffers" tabindex="-1">Alignment of vertex and index buffers <a class="header-anchor" href="#alignment-of-vertex-and-index-buffers" aria-label="Permalink to &quot;Alignment of vertex and index buffers&quot;">â€‹</a></h2><p>Vertex buffers require defining a <code>VertexBufferLayout</code>, so the memory alignment is whatever you tell WebGPU it should be. This can be really convenient for keeping down memory usage on the GPU.</p><p>The Index Buffer uses the alignment of whatever primitive type you specify via the <code>IndexFormat</code> you pass into <code>RenderEncoder::set_index_buffer()</code>.</p><h2 id="alignment-of-uniform-and-storage-buffers" tabindex="-1">Alignment of Uniform and Storage buffers <a class="header-anchor" href="#alignment-of-uniform-and-storage-buffers" aria-label="Permalink to &quot;Alignment of Uniform and Storage buffers&quot;">â€‹</a></h2><p>GPUs are designed to process thousands of pixels in parallel. In order to achieve this, some sacrifices had to be made. Graphics hardware likes to have all the bytes you intend on processing aligned by powers of 2. The exact specifics of why this is are beyond my level of knowledge, but it&#39;s important to know so that you can troubleshoot why your shaders aren&#39;t working.</p><p>Let&#39;s take a look at the following table:</p><hr><table tabindex="0"><thead><tr><th>Type</th><th>Alignment in Bytes</th><th>Size in Bytes</th></tr></thead><tbody><tr><td>scalar (i32, u32, f32)</td><td>4</td><td>4</td></tr><tr><td>vec2&lt;T&gt;</td><td>8</td><td>8</td></tr><tr><td>vec3&lt;T&gt;</td><td><strong>16</strong></td><td>12</td></tr><tr><td>vec4&lt;T&gt;</td><td>16</td><td>16</td></tr></tbody></table><p>You can see for <code>vec3</code> the alignment is the next power of 2 from the size, 16. This can catch beginners (and even veterans) off guard as it&#39;s not the most intuitive. This becomes especially important when we start laying out structs. Take the light struct from the <a href="./../intermediate/tutorial10-lighting/#seeing-the-light">lighting tutorial</a>:</p><p>You can see the full table of the alignments in section <a href="https://www.w3.org/TR/WGSL/#alignment-and-size" target="_blank" rel="noreferrer">4.3.7.1 of the WGSL spec</a></p><div class="language-rust vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Light</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    position</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> vec3f,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    color</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> vec3f,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>So what&#39;s the alignment of this struct? Your first guess would be that it&#39;s the sum of the alignments of the individual fields. That might make sense if we were in Rust-land, but in shader-land, it&#39;s a little more involved. The alignment for a given struct is given by the following equation:</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>// S is the struct in question</span></span>
<span class="line"><span>// M is a member of the struct</span></span>
<span class="line"><span>AlignOf(S) = max(AlignOfMember(S, M1), ... , AlignOfMember(S, Mn))</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>Basically, the alignment of the struct is the maximum of the alignments of the members of the struct. This means that:</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>AlignOf(Light)</span></span>
<span class="line"><span>    = max(AlignOfMember(Light, position), AlignOfMember(Light, color))</span></span>
<span class="line"><span>    = max(16, 16)</span></span>
<span class="line"><span>    = 16</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>This is why the <code>LightUniform</code> has those padding fields. WGPU won&#39;t accept it if the data is not aligned correctly.</p><h2 id="how-to-deal-with-alignment-issues" tabindex="-1">How to deal with alignment issues <a class="header-anchor" href="#how-to-deal-with-alignment-issues" aria-label="Permalink to &quot;How to deal with alignment issues&quot;">â€‹</a></h2><p>In general, 16 is the max alignment you&#39;ll see. In that case, you might think that we should be able to do something like the following:</p><div class="language-rust vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">#[repr(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">C</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, align(16))]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">#[derive(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Debug</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Copy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Clone</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, bytemuck</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Pod</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, bytemuck</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Zeroable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> LightUniform</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    position</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">f32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    color</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">f32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>But this won&#39;t compile. The <a href="https://docs.rs/bytemuck/" target="_blank" rel="noreferrer">bytemuck crate</a> doesn&#39;t work with structs with implicit padding bytes. Rust can&#39;t guarantee that the memory between the fields has been initialized properly. This gave me an error when I tried it:</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>error[E0512]: cannot transmute between types of different sizes, or dependently-sized types</span></span>
<span class="line"><span>   --&gt; code/intermediate/tutorial10-lighting/src/main.rs:246:8</span></span>
<span class="line"><span>    |</span></span>
<span class="line"><span>246 | struct LightUniform {</span></span>
<span class="line"><span>    |        ^^^^^^^^^^^^</span></span>
<span class="line"><span>    |</span></span>
<span class="line"><span>    = note: source type: `LightUniform` (256 bits)</span></span>
<span class="line"><span>    = note: target type: `_::{closure#0}::TypeWithoutPadding` (192 bits)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="additional-resources" tabindex="-1">Additional resources <a class="header-anchor" href="#additional-resources" aria-label="Permalink to &quot;Additional resources&quot;">â€‹</a></h2><p>If you&#39;re looking for more information check out the <a href="https://gist.github.com/teoxoy/936891c16c2a3d1c3c5e7204ac6cd76c" target="_blank" rel="noreferrer">write-up</a> by @teoxoy.</p></div></div></main><footer class="VPDocFooter" data-v-39a288b8 data-v-d4a0bba5><!--[--><!--]--><div class="edit-info" data-v-d4a0bba5><!----><div class="last-updated" data-v-d4a0bba5><p class="VPLastUpdated" data-v-d4a0bba5 data-v-7e05ebdb>ä¸Šæ¬¡æ›´æ–°: <time datetime="2024-07-20T00:59:58.000Z" data-v-7e05ebdb></time></p></div></div><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-d4a0bba5><span class="visually-hidden" id="doc-footer-aria-label" data-v-d4a0bba5>Pager</span><div class="pager" data-v-d4a0bba5><!----></div><div class="pager" data-v-d4a0bba5><a class="VPLink link pager-link next" href="/learn-wgpu-zh/beginner/tutorial1-window" data-v-d4a0bba5><!--[--><span class="desc" data-v-d4a0bba5>ä¸‹ä¸€ç« </span><span class="title" data-v-d4a0bba5>ä¾èµ–ä¸çª—å£</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"glossary_of_terms.md\":\"11n_5Bbg\",\"beginner_tutorial1-window.md\":\"DA2bgqjT\",\"beginner_tutorial3-pipeline_index.md\":\"BY1rjYTg\",\"index.md\":\"rfJPB2c7\",\"beginner_wgsl.md\":\"DgqId73k\",\"beginner_tutorial4-buffer_index.md\":\"f-TyvSTy\",\"beginner_tutorial2-surface_index.md\":\"DsiHvPTH\",\"beginner_tutorial8-depth_index.md\":\"CnjJ5qjd\",\"simuverse.md\":\"D3P_dpkk\",\"beginner_tutorial6-uniforms_index.md\":\"C2FrOeBR\",\"intermediate_pbr-notes.md\":\"-x-k2Qmu\",\"showcase_compute_index.md\":\"C1h2FBI9\",\"integration-and-debugging_android_index.md\":\"vT5h1oES\",\"integration-and-debugging_bevy_index.md\":\"BdCHgnuG\",\"integration-and-debugging_ios_index.md\":\"DenjzxMQ\",\"integration-and-debugging_snapdragon-profiler_index.md\":\"BvZBiyU8\",\"beginner_tutorial7-instancing_index.md\":\"DnM94FcE\",\"integration-and-debugging_xcode_index.md\":\"BPReqqFy\",\"showcase_alignment.md\":\"spCaxCtG\",\"showcase_windowless_index.md\":\"D7_-zHuT\",\"beginner_tutorial5-textures_index.md\":\"CZvE8N6f\",\"intermediate_vertex-animation_index.md\":\"BexpGi4C\",\"intermediate_tutorial12-camera_index.md\":\"CNyE_BmV\",\"beginner_tutorial9-models_index.md\":\"CU5H4B5l\",\"showcase_gifs_index.md\":\"C-S7VRZr\",\"intermediate_compute-pipeline_index.md\":\"B9NHlLDD\",\"intermediate_tutorial11-normals_index.md\":\"SlANwah2\",\"showcase_pong_index.md\":\"DREWuNuZ\",\"intermediate_tutorial13-terrain_index.md\":\"CUmh9e3o\",\"intermediate_tutorial10-lighting_index.md\":\"eHuUS8rK\",\"showcase_threading.md\":\"4d5wKHv8\",\"integration-and-debugging_index.md\":\"DTmT37FU\",\"intermediate_vertex-animation_universal-animation-formula.md\":\"CYArRdeJ\",\"intermediate_hdr_index.md\":\"CE9t9gV-\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"zh-CN\",\"dir\":\"ltr\",\"title\":\"å­¦ä¹  wgpu\",\"description\":\"wgpuï¼šä¸‹ä¸€ä»£è·¨å¹³å°å›¾å½¢æ¥å£ WebGPU çš„ Rust å®ç°\",\"base\":\"/learn-wgpu-zh/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"logo\":\"/res/wgpu-logo.png\",\"lastUpdated\":true,\"lastUpdatedText\":\"ä¸Šæ¬¡æ›´æ–°\",\"docFooter\":{\"prev\":\"ä¸Šä¸€ç« \",\"next\":\"ä¸‹ä¸€ç« \"},\"outlineTitle\":\"æœ¬ç« å†…å®¹\",\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/jinleili/learn-wgpu-zh\"}],\"nav\":[{\"text\":\"Simuverse\",\"link\":\"/simuverse\"},{\"text\":\"wgpu-in-app\",\"link\":\"https://github.com/jinleili/wgpu-in-app\"},{\"text\":\"bevy-in-app\",\"link\":\"https://github.com/jinleili/bevy-in-app\"}],\"sidebar\":{\"/\":[{\"text\":\"åŸºç¡€\",\"collapsible\":true,\"items\":[{\"text\":\"ä¾èµ–ä¸çª—å£\",\"link\":\"/beginner/tutorial1-window\"},{\"text\":\"å±•ç¤ºå¹³é¢ (Surface)\",\"link\":\"/beginner/tutorial2-surface/\"},{\"text\":\"ç®¡çº¿ (Pipeline)\",\"link\":\"/beginner/tutorial3-pipeline/\"},{\"text\":\"ç¼“å†²åŒºä¸ç´¢å¼•\",\"link\":\"/beginner/tutorial4-buffer/\"},{\"text\":\"çº¹ç†å’Œç»‘å®šç»„\",\"link\":\"/beginner/tutorial5-textures/\"},{\"text\":\"Uniform ç¼“å†²åŒºä¸ 3D è™šæ‹Ÿæ‘„åƒæœº\",\"link\":\"/beginner/tutorial6-uniforms/\"},{\"text\":\"å®ä¾‹åŒ–ç»˜åˆ¶\",\"link\":\"/beginner/tutorial7-instancing/\"},{\"text\":\"æ·±åº¦ç¼“å†²åŒº\",\"link\":\"/beginner/tutorial8-depth/\"},{\"text\":\"æ¨¡å‹åŠ è½½\",\"link\":\"/beginner/tutorial9-models/\"},{\"text\":\"ğŸ†• WGSL ç€è‰²å™¨è¯­è¨€\",\"link\":\"/beginner/wgsl\"}]},{\"text\":\"è¿›é˜¶\",\"collapsible\":true,\"items\":[{\"text\":\"å…‰ç…§\",\"link\":\"/intermediate/tutorial10-lighting/\"},{\"text\":\"æ³•çº¿æ˜ å°„\",\"link\":\"/intermediate/tutorial11-normals/\"},{\"text\":\"æ›´å¥½çš„æ‘„åƒæœº\",\"link\":\"/intermediate/tutorial12-camera/\"},{\"text\":\"ğŸ†• è®¡ç®—ç®¡çº¿\",\"link\":\"/intermediate/compute-pipeline/\"},{\"text\":\"ğŸ†• é¡¶ç‚¹åŠ¨ç”»\",\"link\":\"/intermediate/vertex-animation/\"},{\"text\":\"ğŸ†• ä¸‡èƒ½åŠ¨ç”»å…¬å¼\",\"link\":\"/intermediate/vertex-animation/universal-animation-formula.md\"},{\"text\":\"æ¸²æŸ“ HDR åœºæ™¯\",\"link\":\"/intermediate/hdr/\"}]},{\"text\":\"é›†æˆä¸è°ƒè¯•\",\"collapsible\":true,\"items\":[{\"text\":\"æ¥”å­\",\"link\":\"/integration-and-debugging/\"},{\"text\":\"ğŸ†• ä¸ iOS App é›†æˆ\",\"link\":\"/integration-and-debugging/ios/\"},{\"text\":\"ğŸ†• ä¸ Android App é›†æˆ\",\"link\":\"/integration-and-debugging/android/\"},{\"text\":\"ğŸ†• ä½¿ç”¨ Xcode è°ƒè¯• wgpu ç¨‹åº\",\"link\":\"/integration-and-debugging/xcode/\"},{\"text\":\"ğŸ†• ä½¿ç”¨ Snapdragon Profiler è°ƒè¯•\",\"link\":\"/integration-and-debugging/snapdragon-profiler/\"},{\"text\":\"ğŸ†• åœ¨ iOS Android App ä¸­é›†æˆ Bevy æ¸¸æˆå¼•æ“\",\"link\":\"/integration-and-debugging/bevy/\"}]},{\"text\":\"æ¡ˆä¾‹å±•ç¤º\",\"collapsible\":true,\"collapsed\":true,\"items\":[{\"text\":\"ç¦»å±æ¸²æŸ“\",\"link\":\"/showcase/windowless/\"},{\"text\":\"ç”Ÿæˆ GIF åŠ¨å›¾\",\"link\":\"/showcase/gifs/\"},{\"text\":\"Pong\",\"link\":\"/showcase/pong/\"},{\"text\":\"Compute Example: Tangents and Bitangents\",\"link\":\"/showcase/compute/\"}]},{\"text\":\"é™„å½•\",\"items\":[{\"text\":\"ä»‹ç»\",\"link\":\"/index\"},{\"text\":\"æœ¯è¯­ä¸­è‹±å¯¹ç…§è¡¨\",\"link\":\"/GLOSSARY_OF_TERMS\"}]}]}},\"locales\":{\"root\":{\"label\":\"ä¸­æ–‡\"},\"en\":{\"label\":\"English\",\"link\":\"https://sotrh.github.io/learn-wgpu/\"}},\"scrollOffset\":134,\"cleanUrls\":true}");</script>
    
  </body>
</html>